# ê°ì • ë¶„ì„ ê¸°ë°˜ ë‹µê¸€ ìƒì„± ì‹œìŠ¤í…œ ìƒì„¸ ê°€ì´ë“œ

## ðŸ“‘ ëª©ì°¨

1. [ì‹œìŠ¤í…œ ê°œìš”](#ì‹œìŠ¤í…œ-ê°œìš”)
2. [ê¸°ìˆ  ì•„í‚¤í…ì²˜](#ê¸°ìˆ -ì•„í‚¤í…ì²˜)
3. [ê°ì • ë¶„ì„ ì—”ì§„](#ê°ì •-ë¶„ì„-ì—”ì§„)
4. [ë‹µê¸€ ìƒì„± ì—”ì§„](#ë‹µê¸€-ìƒì„±-ì—”ì§„)
5. [ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„](#ë°ì´í„°ë² ì´ìŠ¤-ì„¤ê³„)
6. [API ë ˆí¼ëŸ°ìŠ¤](#api-ë ˆí¼ëŸ°ìŠ¤)
7. [êµ¬í˜„ ì˜ˆì œ](#êµ¬í˜„-ì˜ˆì œ)
8. [ì„±ëŠ¥ ìµœì í™”](#ì„±ëŠ¥-ìµœì í™”)
9. [ë¹„ìš© ë¶„ì„](#ë¹„ìš©-ë¶„ì„)
10. [ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ](#ë§ˆì´ê·¸ë ˆì´ì…˜-ê°€ì´ë“œ)
11. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
12. [ë² ìŠ¤íŠ¸ í”„ëž™í‹°ìŠ¤](#ë² ìŠ¤íŠ¸-í”„ëž™í‹°ìŠ¤)

---

## ì‹œìŠ¤í…œ ê°œìš”

### ë°°ê²½

ë„¤ì´ë²„ í”Œë ˆì´ìŠ¤ê°€ í‰ì /ë³„ì  ì‹œìŠ¤í…œì„ íì§€í•¨ì— ë”°ë¼, ê¸°ì¡´ì˜ `rating` ê¸°ë°˜ ë‹µê¸€ ìƒì„± ì‹œìŠ¤í…œì€ ë” ì´ìƒ ìž‘ë™í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ì— ëŒ€ì‘í•˜ì—¬ **ë¦¬ë·° ë‚´ìš© ìžì²´ë¥¼ ë¶„ì„**í•˜ì—¬ ê°ì •, ì˜ë„, ì£¼ì œë¥¼ íŒŒì•…í•˜ê³  ë§¥ë½ì— ë§žëŠ” ë‹µê¸€ì„ ìƒì„±í•˜ëŠ” ì°¨ì„¸ëŒ€ ì‹œìŠ¤í…œì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤.

### í•µì‹¬ íŠ¹ì§•

| íŠ¹ì§• | ì„¤ëª… |
|-----|------|
| ðŸ§  **3ë‹¨ê³„ í•˜ì´ë¸Œë¦¬ë“œ ë¶„ì„** | ë£° ê¸°ë°˜ â†’ í•œêµ­ì–´ íŠ¹í™” â†’ AI ì •ë°€ ë¶„ì„ |
| ðŸŽ¯ **ë§¥ë½ ì¸ì‹ ë‹µê¸€** | ê°ì •+ì£¼ì œ+í‚¤ì›Œë“œ ê¸°ë°˜ ê°œì¸í™”ëœ ë‹µê¸€ |
| âš¡ **ë¹„ìš© ìµœì í™”** | ì¡°ê±´ë¶€ AI í˜¸ì¶œë¡œ 60% ë¹„ìš© ì ˆê° |
| ðŸ’¾ **ìŠ¤ë§ˆíŠ¸ ìºì‹±** | ì¤‘ë³µ ë¶„ì„ ë°©ì§€ë¡œ 95% API ë¹„ìš© ì ˆì•½ |
| ðŸ“Š **í†µê³„ ìžë™í™”** | ì¼ë³„/ì£¼ë³„ ê°ì • íŠ¸ë Œë“œ ìžë™ ì§‘ê³„ |
| ðŸ”„ **í•˜ìœ„ í˜¸í™˜ì„±** | ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ ì™„ë²½ í˜¸í™˜ |

### ì‹œìŠ¤í…œ ìš”êµ¬ì‚¬í•­

**í•„ìˆ˜**:
- Node.js >= 18.0.0

- OpenAI API í‚¤ (GPT-4o-mini)

**ì„ íƒ**:
- Anthropic API í‚¤ (Claude 3 Haiku)
- Redis (ìºì‹± ê³ ë„í™”)

---

## ê¸°ìˆ  ì•„í‚¤í…ì²˜

### ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Client Layer                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ Desktop App  â”‚  â”‚ Web Dashboardâ”‚  â”‚  API Client  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                  â”‚                  â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       API Gateway Layer                          â”‚
â”‚                    AIServiceV2 (í†µí•© ì¸í„°íŽ˜ì´ìŠ¤)                  â”‚
â”‚  â€¢ ìš”ì²­ ë¼ìš°íŒ…  â€¢ ìºì‹± ê´€ë¦¬  â€¢ DB ì—°ë™  â€¢ ì—ëŸ¬ í•¸ë“¤ë§              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                                    â”‚
          â–¼                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SentimentAnalyzer      â”‚      â”‚   AIReplyGenerator       â”‚
â”‚   (ê°ì • ë¶„ì„ ì—”ì§„)         â”‚      â”‚   (ë‹µê¸€ ìƒì„± ì—”ì§„)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1ï¸âƒ£ ë£° ê¸°ë°˜ ë¶„ì„          â”‚      â”‚ 1ï¸âƒ£ ë¶„ì„ ê²°ê³¼ ìˆ˜ì‹          â”‚
â”‚ 2ï¸âƒ£ í•œêµ­ì–´ íŠ¹í™” ë¶„ì„       â”‚      â”‚ 2ï¸âƒ£ í”„ë¡¬í”„íŠ¸ êµ¬ì„±          â”‚
â”‚ 3ï¸âƒ£ AI ì •ë°€ ë¶„ì„          â”‚      â”‚ 3ï¸âƒ£ AI API í˜¸ì¶œ           â”‚
â”‚                          â”‚      â”‚ 4ï¸âƒ£ í…œí”Œë¦¿ í´ë°±            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                 â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      External Services                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ OpenAI API   â”‚  â”‚ Claude API   â”‚  â”‚  PostgreSQL  â”‚          â”‚
â”‚  â”‚ GPT-4o-mini  â”‚  â”‚ Haiku-3      â”‚  â”‚  Database    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë¦¬ë·° ìž…ë ¥     â”‚ "ì»¤í”¼ê°€ ë§›ìžˆê³  ì§ì›ì´ ì¹œì ˆí•´ìš”!"
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ë‹¨ê³„: ìºì‹œ í™•ì¸                        â”‚
â”‚  â€¢ content_hash ê³„ì‚° (SHA-256)          â”‚
â”‚  â€¢ sentiment_analysis_cache ì¡°íšŒ        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ìºì‹œ ížˆíŠ¸? â”€â”€â”€â”€YESâ”€â”€â”€â”                 â”‚
â”‚      â”‚                â”‚                 â”‚
â”‚      NO               â–¼                 â”‚
â”‚      â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚      â”‚         â”‚ ìºì‹œ ê²°ê³¼ ë°˜í™˜ â”‚         â”‚
â”‚      â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2ë‹¨ê³„: ê°ì • ë¶„ì„                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ”· 1ì°¨: ë£° ê¸°ë°˜ ë¹ ë¥¸ ë¶„ì„               â”‚
â”‚     â€¢ í‚¤ì›Œë“œ ë§¤ì¹­                        â”‚
â”‚     â€¢ ê°ì • ìŠ¤ì½”ì–´ë§                      â”‚
â”‚     â€¢ ì‹ ë¢°ë„ ê³„ì‚°                        â”‚
â”‚     âžœ sentiment: positive (85%)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ”¶ 2ì°¨: í•œêµ­ì–´ íŠ¹í™” ë¶„ì„                â”‚
â”‚     â€¢ ì£¼ì œ ì¶”ì¶œ (6ê°œ ì¹´í…Œê³ ë¦¬)           â”‚
â”‚     â€¢ í‚¤ì›Œë“œ ì¶”ì¶œ                        â”‚
â”‚     â€¢ ì´ìŠˆ íƒì§€                          â”‚
â”‚     âžœ topics: [ë§›/í’ˆì§ˆ, ì„œë¹„ìŠ¤]         â”‚
â”‚     âžœ keywords: [ë§›ìžˆ, ì¹œì ˆ, ì»¤í”¼]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ”º 3ì°¨: AI ì •ë°€ ë¶„ì„ (ì¡°ê±´ë¶€)           â”‚
â”‚     ì¡°ê±´: ë¶€ì • ë¦¬ë·° OR ë³µìž¡í•œ ë¦¬ë·°       â”‚
â”‚     â€¢ GPT-4o-mini í˜¸ì¶œ                  â”‚
â”‚     â€¢ ì˜ë„ íŒŒì•…                          â”‚
â”‚     â€¢ ë‹µê¸€ ì „ëžµ ì œì‹œ                     â”‚
â”‚     âžœ intent: ì¹­ì°¬                      â”‚
â”‚     âžœ reply_focus: [ê°ì‚¬, í’ˆì§ˆìœ ì§€]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3ë‹¨ê³„: ë‹µê¸€ ìƒì„±                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ“ í”„ë¡¬í”„íŠ¸ êµ¬ì„±                        â”‚
â”‚     â€¢ ë¶„ì„ ê²°ê³¼ ìš”ì•½                     â”‚
â”‚     â€¢ ë§¤ìž¥ ì •ë³´                          â”‚
â”‚     â€¢ ë§¥ë½ ê¸°ë°˜ ê°€ì´ë“œë¼ì¸               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ¤– AI API í˜¸ì¶œ                         â”‚
â”‚     â€¢ OpenAI or Claude                  â”‚
â”‚     â€¢ 80-120ìž ë‹µê¸€ ìƒì„±                â”‚
â”‚     â€¢ êµ¬ì²´ì  í‚¤ì›Œë“œ ì¸ìš©                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ðŸ’¾ ê²°ê³¼ ì €ìž¥                            â”‚
â”‚     â€¢ reviews í…Œì´ë¸” ì—…ë°ì´íŠ¸            â”‚
â”‚     â€¢ sentiment_cache ì €ìž¥              â”‚
â”‚     â€¢ review_topics ì €ìž¥                â”‚
â”‚     â€¢ í†µê³„ ìžë™ ì—…ë°ì´íŠ¸                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë‹µê¸€ ë°˜í™˜     â”‚ "ë§›ìžˆê²Œ ë“œì…¨ë‹¤ë‹ˆ ê¸°ì©ë‹ˆë‹¤ ðŸ˜Š
â”‚               â”‚  ì¹œì ˆí•œ ì„œë¹„ìŠ¤ë„ ì¢‹ê²Œ ë´ì£¼ì…”ì„œ
â”‚               â”‚  ê°ì‚¬í•´ìš”!"
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê°ì • ë¶„ì„ ì—”ì§„

### SentimentAnalyzer í´ëž˜ìŠ¤

**íŒŒì¼**: `packages/server/services/sentiment-analyzer.js`

#### 1ë‹¨ê³„: ë£° ê¸°ë°˜ ë¹ ë¥¸ ê°ì • ë¶„ì„

**ëª©ì **: ê°„ë‹¨í•œ ë¦¬ë·°ë¥¼ ë¹ ë¥´ê²Œ ë¶„ë¥˜í•˜ì—¬ AI API ë¹„ìš© ì ˆê°

**ì•Œê³ ë¦¬ì¦˜**:
```javascript
// 1. í‚¤ì›Œë“œ ìŠ¤ì½”ì–´ë§
positiveScore = Î£(í‚¤ì›Œë“œ ì¶œí˜„ íšŸìˆ˜ Ã— ê°€ì¤‘ì¹˜)
negativeScore = Î£(í‚¤ì›Œë“œ ì¶œí˜„ íšŸìˆ˜ Ã— ê°€ì¤‘ì¹˜)

// ê°€ì¤‘ì¹˜
strong: 3ì  (ìµœê³ , ìµœì•…, ì™„ë²½, ë”ì°)
medium: 2ì  (ì¢‹ì•„, ë§›ìžˆ, ë³„ë¡œ, ì‹¤ë§)
weak: 1ì  (ë‚˜ì˜ì§€ì•Š, ê·¸ëŸ­ì €ëŸ­)

// 2. ì¦í­ í‘œí˜„ ê°ì§€
if (contains("ë„ˆë¬´", "ì •ë§", "ì§„ì§œ", "ì™„ì „")) {
  negativeScore *= 1.5
}

// 3. ê°ì • ê²°ì •
if (positiveScore > negativeScore Ã— 1.5) {
  sentiment = "positive"
} else if (negativeScore > positiveScore Ã— 1.5) {
  sentiment = "negative"
} else {
  sentiment = "neutral"
}

// 4. ì‹ ë¢°ë„ ê³„ì‚°
confidence = 0.6 + (dominantScore / totalScore) Ã— 0.35
```

**í‚¤ì›Œë“œ ì‚¬ì „**:
```javascript
sentimentKeywords: {
  positive: {
    strong: ['ìµœê³ ', 'ì™„ë²½', 'í›Œë¥­', 'ê°ë™', 'í™˜ìƒ', 'ëŒ€ë°•'],
    medium: ['ë§›ìžˆ', 'ì¢‹ì•„', 'ì¹œì ˆ', 'ê¹¨ë—', 'ì¶”ì²œ', 'ë§Œì¡±'],
    weak: ['ë‚˜ì˜ì§€ì•Š', 'ê·¸ëŸ­ì €ëŸ­', 'ë¬´ë‚œ']
  },
  negative: {
    strong: ['ìµœì•…', 'ë”ì°', 'í™˜ë¶ˆ', 'ì‹ ê³ ', 'ì“°ë ˆê¸°'],
    medium: ['ë³„ë¡œ', 'ì‹¤ë§', 'ë¶ˆë§Œ', 'í›„íšŒ', 'ì•„ì‰¬'],
    weak: ['ì¡°ê¸ˆ', 'ì•½ê°„', 'ë‹¤ì†Œ']
  }
}
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```javascript
{
  sentiment: 'positive',
  confidence: 0.78,
  scores: { positive: 6, negative: 0 }
}
```

#### 2ë‹¨ê³„: í•œêµ­ì–´ íŠ¹í™” ì£¼ì œ ë° í‚¤ì›Œë“œ ì¶”ì¶œ

**6ëŒ€ ì£¼ì œ ì¹´í…Œê³ ë¦¬**:

| ì£¼ì œ | í‚¤ì›Œë“œ | ê¸ì • í‘œí˜„ | ë¶€ì • í‘œí˜„ |
|-----|--------|----------|----------|
| **ë§›/í’ˆì§ˆ** | ë§›, ìŒì‹, ìš”ë¦¬, ì‹ ì„  | ë§›ìžˆ, ì‹ ì„ , í‘¸ì§ | ë§›ì—†, ì‹ì€, ìƒí•œ |
| **ì„œë¹„ìŠ¤** | ì§ì›, ì•Œë°”, ì‘ëŒ€, íƒœë„ | ì¹œì ˆ, ë¹ ë¥¸, ì •ì¤‘ | ë¶ˆì¹œì ˆ, ëŠë¦°, ë¬´ë¡€ |
| **ë¶„ìœ„ê¸°/ì‹œì„¤** | ì¸í…Œë¦¬ì–´, ì¢Œì„, ê³µê°„ | ê¹”ë”, ì•„ëŠ‘, ë„“ì€ | ë‚¡ì€, ë¶ˆíŽ¸, ì¢ì€ |
| **ì²­ê²°** | ìœ„ìƒ, ê¹¨ë—, ëƒ„ìƒˆ | ì²­ê²°, ê¹¨ë— | ë”ëŸ½, ì§€ì €ë¶„, ë²Œë ˆ |
| **ê°€ê²©** | ê°€ê²©, ê°€ì„±ë¹„, ë¹„ìš© | ì €ë ´, í•©ë¦¬ì  | ë¹„ì‹¸, ë°”ê°€ì§€ |
| **ëŒ€ê¸°ì‹œê°„** | ëŒ€ê¸°, ê¸°ë‹¤ë¦¼, ì‹œê°„ | ë¹ ë¥¸, ì‹ ì† | ëŠë¦°, ì˜¤ëž˜ |

**ì¶”ì¶œ í”„ë¡œì„¸ìŠ¤**:
```javascript
// 1. ì£¼ì œ ê°ì§€
for (topic in topicCategories) {
  if (reviewContains(topic.keywords)) {
    detectedTopics.push(topic)
  }
}

// 2. ì£¼ì œë³„ ê°ì • íŒë‹¨
for (topic in detectedTopics) {
  positiveCount = countMatches(topic.positive)
  negativeCount = countMatches(topic.negative)

  topic.sentiment = positiveCount > negativeCount
    ? 'positive'
    : 'negative'
}

// 3. ì´ìŠˆ íƒì§€ (ë¶€ì • í‚¤ì›Œë“œ)
for (keyword in negativeKeywords) {
  if (reviewContains(keyword)) {
    issues.push({
      topic: keyword.category,
      keyword: keyword.text,
      type: 'negative'
    })
  }
}
```

**ì¶œë ¥ ì˜ˆì‹œ**:
```javascript
{
  topics: [
    {
      topic: 'ë§›/í’ˆì§ˆ',
      sentiment: 'positive',
      score: 3,
      keywords: ['ë§›ìžˆ', 'ì‹ ì„ ', 'ì»¤í”¼']
    },
    {
      topic: 'ì„œë¹„ìŠ¤',
      sentiment: 'positive',
      score: 2,
      keywords: ['ì¹œì ˆ', 'ì§ì›']
    }
  ],
  keywords: ['ë§›ìžˆ', 'ì‹ ì„ ', 'ì»¤í”¼', 'ì¹œì ˆ', 'ì§ì›'],
  issues: []
}
```

#### 3ë‹¨ê³„: AI ì •ë°€ ë¶„ì„

**ì‹¤í–‰ ì¡°ê±´** (í•˜ë‚˜ë¼ë„ ë§Œì¡± ì‹œ):
```javascript
const needsDeepAnalysis =
  sentiment === 'negative' ||        // ë¶€ì • ë¦¬ë·°ëŠ” í•­ìƒ
  content.length > 100 ||            // ê¸´ ë¦¬ë·° (ë³µìž¡)
  topics.length > 2 ||               // ì—¬ëŸ¬ ì£¼ì œ ì–¸ê¸‰
  confidence < 0.7;                  // ë‚®ì€ ì‹ ë¢°ë„
```

**AI í”„ë¡¬í”„íŠ¸**:
```
ë‹¤ìŒ ê³ ê° ë¦¬ë·°ë¥¼ ì •ë°€ ë¶„ì„í•´ì£¼ì„¸ìš”:

ë¦¬ë·°: "ì»¤í”¼ê°€ ë§›ìžˆê³  ì§ì›ì´ ì¹œì ˆí–ˆì§€ë§Œ ëŒ€ê¸°ì‹œê°„ì´ ë„ˆë¬´ ê¸¸ì—ˆì–´ìš”"

ë¶„ì„ í•­ëª©:
1. ì „ì²´ ê°ì • (positive/negative/neutral)
2. ê°ì • ê°•ë„ (0.0 ~ 1.0)
3. ì£¼ìš” ì–¸ê¸‰ ì£¼ì œ (ìµœëŒ€ 3ê°œ)
4. í•µì‹¬ í‚¤ì›Œë“œ (ìµœëŒ€ 5ê°œ)
5. ê³ ê°ì˜ ì£¼ëœ ì˜ë„ (ì¹­ì°¬/ë¶ˆë§Œ/ì œì•ˆ/ë¬¸ì˜)
6. ë‹µê¸€ ìž‘ì„± ì‹œ ê°•ì¡°í•  í¬ì¸íŠ¸ (êµ¬ì²´ì ìœ¼ë¡œ)
7. í”¼í•´ì•¼ í•  ë‹µê¸€ ìš”ì†Œ

JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ:
{
  "sentiment": "neutral",
  "sentiment_strength": 0.6,
  "topics": ["ë§›/í’ˆì§ˆ", "ì„œë¹„ìŠ¤", "ëŒ€ê¸°ì‹œê°„"],
  "keywords": ["ì»¤í”¼", "ë§›ìžˆ", "ì¹œì ˆ", "ëŒ€ê¸°", "ê¸¸"],
  "intent": "ì œì•ˆ",
  "reply_focus": ["ë§›ê³¼ ì„œë¹„ìŠ¤ ê°ì‚¬", "ëŒ€ê¸°ì‹œê°„ ê°œì„  ì•½ì†"],
  "reply_avoid": ["ë³€ëª…", "ì±…ìž„ íšŒí”¼"],
  "summary": "ê¸ì •ì ì´ë‚˜ ëŒ€ê¸°ì‹œê°„ ë¶ˆë§Œ"
}
```

**ëª¨ë¸ ì„¤ì •**:
```javascript
{
  model: 'gpt-4o-mini',
  temperature: 0.3,        // ì¼ê´€ì„± ì¤‘ì‹œ
  max_tokens: 500,
  response_format: { type: 'json_object' }
}
```

#### í†µí•© ë¶„ì„ ê²°ê³¼

**ìµœì¢… ì¶œë ¥ êµ¬ì¡°**:
```javascript
{
  // ê°ì • ë¶„ì„
  success: true,
  sentiment: 'positive',           // positive/negative/neutral
  sentiment_strength: 0.85,        // 0.0 ~ 1.0

  // ì£¼ì œ ë° í‚¤ì›Œë“œ
  topics: ['ë§›/í’ˆì§ˆ', 'ì„œë¹„ìŠ¤'],
  keywords: ['ë§›ìžˆ', 'ì¹œì ˆ', 'ì»¤í”¼', 'ì§ì›'],

  // ì˜ë„ ë° ì „ëžµ
  intent: 'ì¹­ì°¬',                  // ì¹­ì°¬/ë¶ˆë§Œ/ì œì•ˆ/ë¬¸ì˜
  reply_focus: [                   // ë‹µê¸€ì—ì„œ ê°•ì¡°í•  í¬ì¸íŠ¸
    'êµ¬ì²´ì ì¸ ì¹­ì°¬ í¬ì¸íŠ¸ ê°ì‚¬',
    'ì§€ì†ì ì¸ í’ˆì§ˆ ì•½ì†'
  ],
  reply_avoid: [                   // í”¼í•´ì•¼ í•  ìš”ì†Œ
    'í˜•ì‹ì ì¸ ë‹µë³€',
    'ê³¼ë„í•œ ë§ˆì¼€íŒ…'
  ],
  summary: 'ì»¤í”¼ ë§›ê³¼ ì„œë¹„ìŠ¤ ì¹­ì°¬',

  // ë©”íƒ€ ì •ë³´
  analysis_depth: 'deep',          // quick/deep
  analysis_source: 'ai',           // rule-based/ai/cache
  model_used: 'gpt-4o-mini',
  analysis_time_ms: 842,

  // ìƒì„¸ ì •ë³´ (ë””ë²„ê¹…ìš©)
  details: {
    quick_scores: { positive: 6, negative: 0 },
    detected_topics: [...],
    issues: []
  }
}
```

---

## ë‹µê¸€ ìƒì„± ì—”ì§„

### AIReplyGenerator í´ëž˜ìŠ¤

**íŒŒì¼**: `packages/server/services/ai-reply-generator.js`

#### í”„ë¡œì„¸ìŠ¤ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë¶„ì„ ê²°ê³¼ ìž…ë ¥         â”‚
â”‚  â€¢ sentiment           â”‚
â”‚  â€¢ topics              â”‚
â”‚  â€¢ keywords            â”‚
â”‚  â€¢ intent              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ê°ì •ë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ positive:              â”‚
â”‚  "ì§„ì •ì„± ìžˆëŠ” ê°ì‚¬"     â”‚
â”‚ negative:              â”‚
â”‚  "ì§„ì‹¬ ì–´ë¦° ì‚¬ê³¼ì™€ ê°œì„ "â”‚
â”‚ neutral:               â”‚
â”‚  "ë°©ë¬¸ ê°ì‚¬ì™€ ê°œì„  ì˜ì§€"â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ê³ ë„í™” í”„ë¡¬í”„íŠ¸ êµ¬ì„±   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ë¶„ì„ ê²°ê³¼]            â”‚
â”‚ [ë¦¬ë·° ë‚´ìš©]            â”‚
â”‚ [ë§¤ìž¥ ì •ë³´]            â”‚
â”‚ [ê°€ì´ë“œë¼ì¸]           â”‚
â”‚ [êµ¬ì²´ì  ìš”êµ¬ì‚¬í•­]       â”‚
â”‚ [í”¼í•´ì•¼ í•  ìš”ì†Œ]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI API í˜¸ì¶œ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ OpenAI GPT-4o-mini     â”‚
â”‚ or                     â”‚
â”‚ Claude 3 Haiku         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ max_tokens: 250        â”‚
â”‚ temperature: 0.7       â”‚
â”‚ presence_penalty: 0.4  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ë‹µê¸€ ê²€ì¦ ë° í›„ì²˜ë¦¬    â”‚
â”‚  â€¢ ê¸¸ì´ ì²´í¬ (80-120ìž)â”‚
â”‚  â€¢ ì´ëª¨ì§€ ì ì ˆì„±        â”‚
â”‚  â€¢ í‚¤ì›Œë“œ í¬í•¨ ì—¬ë¶€     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ìƒì„±ëœ ë‹µê¸€ ë°˜í™˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ê°ì •ë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸

**ê¸ì • ë¦¬ë·°**:
```
ë‹¹ì‹ ì€ í•œêµ­ í”„ëžœì°¨ì´ì¦ˆ ë§¤ìž¥ì˜ ì „ë¬¸ì ì´ê³  ì§„ì‹¬ì–´ë¦° ê³ ê° ì„œë¹„ìŠ¤ ë‹´ë‹¹ìžìž…ë‹ˆë‹¤.

ê³ ê°ì˜ ê¸ì •ì ì¸ ë¦¬ë·°ì— ê°ì‚¬í•˜ë©°, ì§„ì •ì„± ìžˆê³  ë”°ëœ»í•œ ë‹µê¸€ì„ ìž‘ì„±í•©ë‹ˆë‹¤.
í˜•ì‹ì ì´ì§€ ì•Šê³  ê³ ê°ì´ ì–¸ê¸‰í•œ êµ¬ì²´ì ì¸ ë‚´ìš©ì„ ì¸ìš©í•˜ì—¬ ë‹µë³€í•©ë‹ˆë‹¤.
```

**ë¶€ì • ë¦¬ë·°**:
```
ë‹¹ì‹ ì€ í•œêµ­ í”„ëžœì°¨ì´ì¦ˆ ë§¤ìž¥ì˜ ì „ë¬¸ì ì´ê³  ì§„ì‹¬ì–´ë¦° ê³ ê° ì„œë¹„ìŠ¤ ë‹´ë‹¹ìžìž…ë‹ˆë‹¤.

ê³ ê°ì˜ ë¶ˆë§Œì— ì§„ì‹¬ìœ¼ë¡œ ê³µê°í•˜ê³  ì‚¬ê³¼í•˜ë©°, êµ¬ì²´ì ì¸ ê°œì„  ë°©ì•ˆì„ ì œì‹œí•©ë‹ˆë‹¤.
ë³€ëª…í•˜ê±°ë‚˜ ì±…ìž„ì„ íšŒí”¼í•˜ì§€ ì•Šê³ , ë¬¸ì œë¥¼ ì •í™•ížˆ ì´í•´í–ˆìŒì„ ë³´ì—¬ì¤ë‹ˆë‹¤.
```

**ì¤‘ë¦½ ë¦¬ë·°**:
```
ë‹¹ì‹ ì€ í•œêµ­ í”„ëžœì°¨ì´ì¦ˆ ë§¤ìž¥ì˜ ì „ë¬¸ì ì´ê³  ì§„ì‹¬ì–´ë¦° ê³ ê° ì„œë¹„ìŠ¤ ë‹´ë‹¹ìžìž…ë‹ˆë‹¤.

ê³ ê°ì˜ ë°©ë¬¸ê³¼ í”¼ë“œë°±ì— ê°ì‚¬í•˜ë©°, ë” ë‚˜ì€ ê²½í—˜ì„ ì œê³µí•˜ê² ë‹¤ëŠ” ì˜ì§€ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.
```

#### ê³ ë„í™” í”„ë¡¬í”„íŠ¸ êµ¬ì¡°

**í…œí”Œë¦¿**:
```
[ê³ ê° ë¦¬ë·° ë¶„ì„ ê²°ê³¼]
ê°ì •: {sentiment} (ê°•ë„: {strength}%)
ê³ ê° ì˜ë„: {intent}
ì£¼ìš” ì£¼ì œ: {topics}
í•µì‹¬ í‚¤ì›Œë“œ: {keywords}

[ë¦¬ë·° ë‚´ìš©]
"{reviewContent}"

[ë§¤ìž¥ ì •ë³´]
- ë§¤ìž¥ëª…/ìœ í˜•: {brandContext}

[ë‹µê¸€ ìž‘ì„± ìš”ì²­]
ìœ„ ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ {ë‹µê¸€ì „ëžµ} ìž‘ì„±í•´ì£¼ì„¸ìš”.

[í•„ìˆ˜ ê°€ì´ë“œë¼ì¸]
1. **ê¸¸ì´**: 80~120ìž (ê³µë°± í¬í•¨)
2. **í†¤**: {tone}
3. **êµ¬ì¡°**:
   - ì²« ë¬¸ìž¥: {ì²«ë¬¸ìž¥ì „ëžµ}
   - ì¤‘ê°„: {ê°•ì¡°í¬ì¸íŠ¸}
   - ë§ˆì§€ë§‰: {ë§ˆë¬´ë¦¬ì „ëžµ}

[êµ¬ì²´ì  ìš”êµ¬ì‚¬í•­]
- ê³ ê°ì´ êµ¬ì²´ì ìœ¼ë¡œ ì–¸ê¸‰í•œ ë¶€ë¶„ ({keywords}) ì„ ì§ì ‘ ì¸ìš©í•˜ë©° ê°ì‚¬/ì‚¬ê³¼ í‘œí˜„
- {specific_guidelines}
- ì´ëª¨ì§€ ì‚¬ìš©: {emoji_policy}

[í”¼í•´ì•¼ í•  ìš”ì†Œ]
- {reply_avoid}
- ê³¼ë„í•œ ë§ˆì¼€íŒ… ë¬¸êµ¬
- ë³µì‚¬-ë¶™ì—¬ë„£ê¸° ëŠë‚Œë‚˜ëŠ” í…œí”Œë¦¿
- ê³ ê° ë¦¬ë·°ë¥¼ ì œëŒ€ë¡œ ì½ì§€ ì•Šì€ ë“¯í•œ ì¼ë°˜ì ì¸ ë‹µë³€

[ì¶œë ¥ í˜•ì‹]
ë‹µê¸€ë§Œ ì¶œë ¥í•˜ì„¸ìš”. ì¶”ê°€ ì„¤ëª…ì´ë‚˜ ë©”íƒ€ ì •ë³´ëŠ” í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.
```

#### ê°ì •ë³„ ë‹µê¸€ ì „ëžµ

**ê¸ì • ë¦¬ë·° (positive)**:
```javascript
{
  ë‹µê¸€ì „ëžµ: 'ê°ì‚¬ì™€ ì¹­ì°¬ì— ëŒ€í•œ ì§„ì‹¬ì–´ë¦° ì‘ë‹µ',
  tone: 'ì¹œê·¼í•˜ê³  ë”°ëœ»í•œ',
  ì²«ë¬¸ìž¥ì „ëžµ: 'êµ¬ì²´ì  ê°ì‚¬',
  ê°•ì¡°í¬ì¸íŠ¸: ['ì¹­ì°¬ë°›ì€ ë¶€ë¶„ ì¸ìš©', 'ê°ì‚¬ í‘œí˜„'],
  ë§ˆë¬´ë¦¬ì „ëžµ: 'ì§€ì†ì  ì„œë¹„ìŠ¤ ì•½ì†',
  specific_guidelines: `
    - ê³ ê°ì´ ì–¸ê¸‰í•œ ë¶€ë¶„ (ì˜ˆ: "ë§›ìžˆ", "ì¹œì ˆ") ì§ì ‘ ì¸ìš©
    - "ì•žìœ¼ë¡œë„ ê¸°ëŒ€ì— ë¶€ì‘í•˜ê² ë‹¤"ëŠ” ì•½ì†
    - ì´ëª¨ì§€ 1ê°œ ì‚¬ìš© ê°€ëŠ¥ (ðŸ˜Š, ðŸ’•, âœ¨)
  `,
  emoji_policy: '1ê°œ ì‚¬ìš© ê°€ëŠ¥',
  reply_avoid: ['í˜•ì‹ì ì¸ ë‹µë³€', 'ê³¼ë„í•œ ì¹­ì°¬']
}
```

**ë¶€ì • ë¦¬ë·° (negative)**:
```javascript
{
  ë‹µê¸€ì „ëžµ: 'ì§„ì‹¬ì–´ë¦° ì‚¬ê³¼ì™€ êµ¬ì²´ì ì¸ ê°œì„  ì•½ì†',
  tone: 'ì§„ì§€í•˜ê³  ì§„ì‹¬ì–´ë¦°',
  ì²«ë¬¸ìž¥ì „ëžµ: 'ì§„ì‹¬ì–´ë¦° ì‚¬ê³¼',
  ê°•ì¡°í¬ì¸íŠ¸: ['ë¶ˆíŽ¸í–ˆë˜ ë¶€ë¶„ ê³µê°', 'êµ¬ì²´ì  ê°œì„  ë°©ì•ˆ'],
  ë§ˆë¬´ë¦¬ì „ëžµ: 'ê°œì„  ì•½ì†',
  specific_guidelines: `
    - ê³ ê°ì´ ë¶ˆíŽ¸í–ˆë˜ êµ¬ì²´ì ì¸ ë¶€ë¶„ ì–¸ê¸‰í•˜ë©° ê³µê°
    - ë³€ëª…í•˜ì§€ ì•Šê³  ì†”ì§í•˜ê²Œ ì‚¬ê³¼
    - "{ì£¼ì œ}"ì— ëŒ€í•œ êµ¬ì²´ì ì¸ ê°œì„  ë°©ì•ˆ ì œì‹œ
    - ìž¬ë°©ë¬¸ ìœ ë„ë³´ë‹¤ëŠ” ì‹ ë¢° íšŒë³µì— ì´ˆì 
  `,
  emoji_policy: 'ì‚¬ìš© ìžì œ (ì§„ì§€í•¨ ìœ ì§€)',
  reply_avoid: ['ë³€ëª…', 'ì±…ìž„ íšŒí”¼', 'í˜•ì‹ì  ì‚¬ê³¼']
}
```

**ì¤‘ë¦½ ë¦¬ë·° (neutral)**:
```javascript
{
  ë‹µê¸€ì „ëžµ: 'ë°©ë¬¸ ê°ì‚¬ ë° ê°œì„  ì˜ì§€',
  tone: 'ì •ì¤‘í•˜ê³  ì¹œì ˆí•œ',
  ì²«ë¬¸ìž¥ì „ëžµ: 'ë°©ë¬¸ ê°ì‚¬',
  ê°•ì¡°í¬ì¸íŠ¸: ['í”¼ë“œë°± ê°ì‚¬', 'ê°œì„  ì˜ì§€'],
  ë§ˆë¬´ë¦¬ì „ëžµ: 'ìž¬ë°©ë¬¸ ê¸°ëŒ€',
  specific_guidelines: `
    - ë°©ë¬¸ê³¼ í”¼ë“œë°±ì— ëŒ€í•œ ê°ì‚¬
    - ë” ë‚˜ì€ ê²½í—˜ ì œê³µ ì˜ì§€
    - ì´ëª¨ì§€ ì ì ˆížˆ ì‚¬ìš© (ðŸ˜Š)
  `,
  emoji_policy: 'ì ì ˆížˆ ì‚¬ìš©',
  reply_avoid: ['ê³¼ë„í•œ ë§ˆì¼€íŒ…']
}
```

#### ì‹¤ì œ í”„ë¡¬í”„íŠ¸ ì˜ˆì‹œ

**ìž…ë ¥ ë¦¬ë·°**: "ì»¤í”¼ê°€ ì •ë§ ë§›ìžˆì—ˆì–´ìš”! ì§ì›ë¶„ë“¤ë„ ë„ˆë¬´ ì¹œì ˆí•˜ì‹œê³  ë¶„ìœ„ê¸°ë„ ì•„ëŠ‘í•´ì„œ ì¢‹ì•˜ìŠµë‹ˆë‹¤. ìžì£¼ ì˜¬ê²Œìš”~"

**ìƒì„±ëœ í”„ë¡¬í”„íŠ¸**:
```
[ê³ ê° ë¦¬ë·° ë¶„ì„ ê²°ê³¼]
ê°ì •: positive (ê°•ë„: 85%)
ê³ ê° ì˜ë„: ì¹­ì°¬
ì£¼ìš” ì£¼ì œ: ë§›/í’ˆì§ˆ, ì„œë¹„ìŠ¤, ë¶„ìœ„ê¸°/ì‹œì„¤
í•µì‹¬ í‚¤ì›Œë“œ: ì»¤í”¼, ë§›ìžˆ, ì¹œì ˆ, ë¶„ìœ„ê¸°, ì•„ëŠ‘

[ë¦¬ë·° ë‚´ìš©]
"ì»¤í”¼ê°€ ì •ë§ ë§›ìžˆì—ˆì–´ìš”! ì§ì›ë¶„ë“¤ë„ ë„ˆë¬´ ì¹œì ˆí•˜ì‹œê³  ë¶„ìœ„ê¸°ë„ ì•„ëŠ‘í•´ì„œ ì¢‹ì•˜ìŠµë‹ˆë‹¤. ìžì£¼ ì˜¬ê²Œìš”~"

[ë§¤ìž¥ ì •ë³´]
- ë§¤ìž¥ëª…/ìœ í˜•: ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì 

[ë‹µê¸€ ìž‘ì„± ìš”ì²­]
ìœ„ ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê°ì‚¬ì™€ ì¹­ì°¬ì— ëŒ€í•œ ì§„ì‹¬ì–´ë¦° ì‘ë‹µ ìž‘ì„±í•´ì£¼ì„¸ìš”.

[í•„ìˆ˜ ê°€ì´ë“œë¼ì¸]
1. **ê¸¸ì´**: 80~120ìž (ê³µë°± í¬í•¨)
2. **í†¤**: ì¹œê·¼í•˜ê³  ë”°ëœ»í•œ
3. **êµ¬ì¡°**:
   - ì²« ë¬¸ìž¥: êµ¬ì²´ì  ê°ì‚¬
   - ì¤‘ê°„: ê°ì‚¬ í‘œí˜„, ì§€ì†ì  ì„œë¹„ìŠ¤ ì•½ì†
   - ë§ˆì§€ë§‰: ì§€ì†ì  ì„œë¹„ìŠ¤ ì•½ì†

[êµ¬ì²´ì  ìš”êµ¬ì‚¬í•­]
- ê³ ê°ì´ êµ¬ì²´ì ìœ¼ë¡œ ì–¸ê¸‰í•œ ë¶€ë¶„ (ì»¤í”¼, ë§›ìžˆ, ì¹œì ˆ, ë¶„ìœ„ê¸°, ì•„ëŠ‘) ì„ ì§ì ‘ ì¸ìš©í•˜ë©° ê°ì‚¬ í‘œí˜„
- "ì•žìœ¼ë¡œë„ ê¸°ëŒ€ì— ë¶€ì‘í•˜ê² ë‹¤"ëŠ” ì•½ì†
- ì´ëª¨ì§€ 1ê°œ ì‚¬ìš© ê°€ëŠ¥ (ðŸ˜Š, ðŸ’•, âœ¨ ì¤‘ ì„ íƒ)
- í˜•ì‹ì ì´ì§€ ì•Šê³  ì§„ì •ì„± ìžˆê²Œ

[í”¼í•´ì•¼ í•  ìš”ì†Œ]
- í˜•ì‹ì ì¸ ë‹µë³€
- ê³¼ë„í•œ ë§ˆì¼€íŒ… ë¬¸êµ¬
- ë³µì‚¬-ë¶™ì—¬ë„£ê¸° ëŠë‚Œë‚˜ëŠ” í…œí”Œë¦¿
- ê³ ê° ë¦¬ë·°ë¥¼ ì œëŒ€ë¡œ ì½ì§€ ì•Šì€ ë“¯í•œ ì¼ë°˜ì ì¸ ë‹µë³€

[ì¶œë ¥ í˜•ì‹]
ë‹µê¸€ë§Œ ì¶œë ¥í•˜ì„¸ìš”. ì¶”ê°€ ì„¤ëª…ì´ë‚˜ ë©”íƒ€ ì •ë³´ëŠ” í¬í•¨í•˜ì§€ ë§ˆì„¸ìš”.
```

**AI ìƒì„± ë‹µê¸€**:
```
ì»¤í”¼ ë§›ìžˆê²Œ ë“œì…¨ë‹¤ë‹ˆ ì •ë§ ê¸°ì©ë‹ˆë‹¤ ðŸ˜Š ì¹œì ˆí•œ ì„œë¹„ìŠ¤ì™€ ì•„ëŠ‘í•œ ë¶„ìœ„ê¸°ë„ ì¢‹ê²Œ ë´ì£¼ì…”ì„œ ê°ì‚¬í•´ìš”. ì•žìœ¼ë¡œë„ ê¸°ëŒ€ì— ë¶€ì‘í•˜ëŠ” ë§¤ìž¥ì´ ë˜ê² ìŠµë‹ˆë‹¤!
```

#### í…œí”Œë¦¿ í´ë°± ì‹œìŠ¤í…œ

AI API ì‹¤íŒ¨ ì‹œ ì‚¬ìš©í•˜ëŠ” **ê³ ê¸‰ í…œí”Œë¦¿**:

**ê¸ì • ë¦¬ë·° í…œí”Œë¦¿**:
```javascript
templates: {
  general: [
    "{keyword}ì— ëŒ€í•´ ì¢‹ê²Œ ë´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ ðŸ˜Š ì•žìœ¼ë¡œë„ {topic}ì— ë”ìš± ì‹ ê²½ì¨ì„œ ë§Œì¡±ìŠ¤ëŸ¬ìš´ ê²½í—˜ ë“œë¦¬ê² ìŠµë‹ˆë‹¤!",
    "{keyword}í•´ì£¼ì…”ì„œ ì •ë§ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤! ê³ ê°ë‹˜ê»˜ì„œ ë§Œì¡±í•˜ì‹  {topic}ì„ ê³„ì† ìœ ì§€í•˜ë©° ë°œì „í•˜ê² ìŠµë‹ˆë‹¤ ðŸ’•"
  ],
  specific: [
    "{topic}ì— ëŒ€í•´ ì¢‹ê²Œ í‰ê°€í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤ ðŸ˜Š í•­ìƒ ìµœì„ ì„ ë‹¤í•˜ëŠ” ëª¨ìŠµ ë³´ì—¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤!",
    "{keyword}ì´ ë§Œì¡±ìŠ¤ëŸ¬ìš°ì…¨ë‹¤ë‹ˆ ì •ë§ ê¸°ì©ë‹ˆë‹¤! ì•žìœ¼ë¡œë„ {topic} ê´€ë ¨í•´ì„œ ë”ìš± ë…¸ë ¥í•˜ê² ìŠµë‹ˆë‹¤ ðŸ’•"
  ]
}
```

**ë¶€ì • ë¦¬ë·° í…œí”Œë¦¿**:
```javascript
templates: {
  general: [
    "{keyword} ë“œë ¤ ì •ë§ ì£„ì†¡í•©ë‹ˆë‹¤. ë§ì”€í•˜ì‹  {topic}ì€ ì¦‰ì‹œ ì ê²€í•˜ì—¬ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤.",
    "{topic}ì—ì„œ ê¸°ëŒ€ì— ë¯¸ì¹˜ì§€ ëª»í•œ ì  ì§„ì‹¬ìœ¼ë¡œ ì‚¬ê³¼ë“œë¦½ë‹ˆë‹¤. ì „ ì§ì›ê³¼ ê°œì„  ë°©ì•ˆì„ ë…¼ì˜í•˜ì—¬ ìž¬ë°œë°©ì§€í•˜ê² ìŠµë‹ˆë‹¤."
  ],
  specific: [
    "{topic} ê´€ë ¨í•˜ì—¬ ë¶ˆíŽ¸ì„ ë“œë¦° ì  ê¹Šì´ ì‚¬ê³¼ë“œë¦½ë‹ˆë‹¤. í•´ë‹¹ ë¶€ë¶„ì€ ì¦‰ì‹œ ê°œì„  ì¡°ì¹˜ë¥¼ ì·¨í•˜ê² ìŠµë‹ˆë‹¤.",
    "{keyword}ì— ëŒ€í•œ ì§€ì  ê°ì‚¬ë“œë¦¬ë©°, ì§„ì‹¬ìœ¼ë¡œ ì‚¬ê³¼ë“œë¦½ë‹ˆë‹¤. {topic}ì€ ìš°ì„ ì ìœ¼ë¡œ ê°œì„ í•˜ê² ìŠµë‹ˆë‹¤."
  ]
}
```

**í…œí”Œë¦¿ ì„ íƒ ë¡œì§**:
```javascript
// 1. ë¶„ì„ ê²°ê³¼ì—ì„œ ì²« ë²ˆì§¸ ì£¼ì œì™€ í‚¤ì›Œë“œ ì¶”ì¶œ
const firstTopic = analysis.topics[0] || 'ì„œë¹„ìŠ¤'
const firstKeyword = analysis.keywords[0] || 'ì¢‹ì€ ê²½í—˜'

// 2. í…œí”Œë¦¿ ì„ íƒ
const sentimentTemplates = templates[analysis.sentiment]
let selectedTemplates = sentimentTemplates.general

// êµ¬ì²´ì ì¸ ì£¼ì œê°€ ìžˆìœ¼ë©´ specific í…œí”Œë¦¿ ìš°ì„  ì‚¬ìš©
if (sentimentTemplates.specific && analysis.topics.length > 0) {
  selectedTemplates = [...sentimentTemplates.specific, ...sentimentTemplates.general]
}

// 3. ëžœë¤ ì„ íƒ ë° ë³€ìˆ˜ ì¹˜í™˜
let reply = selectedTemplates[Math.floor(Math.random() * selectedTemplates.length)]
reply = reply.replace('{topic}', firstTopic)
reply = reply.replace('{keyword}', firstKeyword)
```

---

## ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### í…Œì´ë¸” êµ¬ì¡°

#### 1. reviews (í™•ìž¥)

**ê¸°ì¡´ ì»¬ëŸ¼ ìœ ì§€ + ì‹ ê·œ ì»¬ëŸ¼ ì¶”ê°€**:

```sql
CREATE TABLE reviews (
    -- ê¸°ì¡´ ì»¬ëŸ¼
    id INTEGER PRIMARY KEY,
    franchise_id INTEGER NOT NULL,
    naver_review_id VARCHAR(200) UNIQUE NOT NULL,
    author VARCHAR(200),
    content TEXT NOT NULL,
    rating INTEGER,  -- DEPRECATED, í•˜ìœ„ í˜¸í™˜ìš©
    review_date TIMESTAMP,
    source_url TEXT,
    collected_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    synced_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    -- ì‹ ê·œ: ê°ì • ë¶„ì„ ì»¬ëŸ¼
    sentiment VARCHAR(20),               -- positive/negative/neutral
    sentiment_strength DECIMAL(3,2),     -- 0.00 ~ 1.00
    sentiment_keywords TEXT[],           -- ['ë§›ìžˆ', 'ì¹œì ˆ'] (PostgreSQL)
    sentiment_topics TEXT[],             -- ['ë§›/í’ˆì§ˆ', 'ì„œë¹„ìŠ¤']
    customer_intent VARCHAR(50),         -- ì¹­ì°¬/ë¶ˆë§Œ/ì œì•ˆ/ë¬¸ì˜
    analysis_model VARCHAR(100),         -- gpt-4o-mini
    analysis_source VARCHAR(50),         -- ai/rule-based/cache
    analyzed_at TIMESTAMP,               -- ë¶„ì„ ì¼ì‹œ

    FOREIGN KEY (franchise_id) REFERENCES franchises(id) ON DELETE CASCADE
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_reviews_sentiment ON reviews(sentiment);
CREATE INDEX idx_reviews_sentiment_franchise ON reviews(franchise_id, sentiment);
CREATE INDEX idx_reviews_analyzed_at ON reviews(analyzed_at);
CREATE INDEX idx_reviews_intent ON reviews(customer_intent);
```

#### 2. sentiment_analysis_cache (ì‹ ê·œ)

**ì¤‘ë³µ ë¶„ì„ ë°©ì§€ ìºì‹œ í…Œì´ë¸”**:

```sql
CREATE TABLE sentiment_analysis_cache (
    id SERIAL PRIMARY KEY,

    -- ìºì‹œ í‚¤
    content_hash VARCHAR(64) UNIQUE NOT NULL,  -- SHA-256
    content_preview TEXT,                       -- ì²˜ìŒ 100ìž (ë””ë²„ê¹…ìš©)

    -- ë¶„ì„ ê²°ê³¼
    sentiment VARCHAR(20) NOT NULL,
    sentiment_strength DECIMAL(3,2),
    topics TEXT[],                              -- ['ë§›/í’ˆì§ˆ', 'ì„œë¹„ìŠ¤']
    keywords TEXT[],                            -- ['ë§›ìžˆ', 'ì¹œì ˆ']
    intent VARCHAR(50),
    reply_focus TEXT[],                         -- ['ê°ì‚¬ í‘œí˜„']
    reply_avoid TEXT[],                         -- ['í˜•ì‹ì  ë‹µë³€']
    summary TEXT,

    -- ë©”íƒ€ ì •ë³´
    analysis_model VARCHAR(100),
    analysis_source VARCHAR(50),
    analysis_time_ms INTEGER,

    -- ì‚¬ìš© í†µê³„
    hit_count INTEGER DEFAULT 0,                -- ìºì‹œ ížˆíŠ¸ íšŸìˆ˜
    last_used_at TIMESTAMP,                     -- ë§ˆì§€ë§‰ ì‚¬ìš©

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_sentiment_cache_hash ON sentiment_analysis_cache(content_hash);
CREATE INDEX idx_sentiment_cache_sentiment ON sentiment_analysis_cache(sentiment);
CREATE INDEX idx_sentiment_cache_last_used ON sentiment_analysis_cache(last_used_at);
```

**ìºì‹œ ì‚¬ìš© ì˜ˆì‹œ**:
```javascript
// 1. í•´ì‹œ ê³„ì‚°
const crypto = require('crypto');
const hash = crypto.createHash('sha256').update(content).digest('hex');

// 2. ìºì‹œ ì¡°íšŒ
const cached = await pool.query(
  'SELECT * FROM sentiment_analysis_cache WHERE content_hash = $1',
  [hash]
);

if (cached.rows.length > 0) {
  // 3. ížˆíŠ¸ ì¹´ìš´íŠ¸ ì¦ê°€
  await pool.query(
    'UPDATE sentiment_analysis_cache SET hit_count = hit_count + 1, last_used_at = NOW() WHERE content_hash = $1',
    [hash]
  );

  return cached.rows[0];  // ìºì‹œ ížˆíŠ¸!
}

// 4. ìºì‹œ ë¯¸ìŠ¤ â†’ ìƒˆë¡œ ë¶„ì„ í›„ ì €ìž¥
const analysis = await analyzer.analyze(content);
await pool.query(
  'INSERT INTO sentiment_analysis_cache (...) VALUES (...)',
  [hash, analysis...]
);
```

#### 3. review_topics (ì‹ ê·œ)

**ë¦¬ë·°ë³„ ì£¼ì œ ë¶„ë¥˜ í…Œì´ë¸”**:

```sql
CREATE TABLE review_topics (
    id SERIAL PRIMARY KEY,
    review_id INTEGER NOT NULL,
    franchise_id INTEGER NOT NULL,

    -- ì£¼ì œ ì •ë³´
    topic_name VARCHAR(100) NOT NULL,           -- 'ë§›/í’ˆì§ˆ'
    topic_sentiment VARCHAR(20),                -- positive/negative/neutral
    keywords TEXT[],                            -- í•´ë‹¹ ì£¼ì œì˜ í‚¤ì›Œë“œ
    confidence DECIMAL(3,2),                    -- ì‹ ë¢°ë„ (0.00 ~ 1.00)

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (review_id) REFERENCES reviews(id) ON DELETE CASCADE,
    FOREIGN KEY (franchise_id) REFERENCES franchises(id) ON DELETE CASCADE
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_review_topics_review ON review_topics(review_id);
CREATE INDEX idx_review_topics_franchise ON review_topics(franchise_id);
CREATE INDEX idx_review_topics_name ON review_topics(topic_name);
CREATE INDEX idx_review_topics_sentiment ON review_topics(topic_sentiment);
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```sql
-- ê°€ë§¹ì ì˜ ì£¼ì œë³„ ì–¸ê¸‰ í†µê³„
SELECT
    topic_name,
    topic_sentiment,
    COUNT(*) as mention_count,
    ROUND(AVG(confidence), 2) as avg_confidence
FROM review_topics
WHERE franchise_id = 123
    AND created_at >= CURRENT_DATE - INTERVAL '30 days'
GROUP BY topic_name, topic_sentiment
ORDER BY mention_count DESC;

-- ê²°ê³¼:
-- topic_name  | topic_sentiment | mention_count | avg_confidence
-- ë§›/í’ˆì§ˆ     | positive        | 45            | 0.82
-- ì„œë¹„ìŠ¤      | positive        | 38            | 0.75
-- ê°€ê²©        | negative        | 12            | 0.68
```

#### 4. sentiment_analysis_stats (ì‹ ê·œ)

**ì¼ë³„/ì£¼ë³„/ì›”ë³„ í†µê³„ ì§‘ê³„ í…Œì´ë¸”**:

```sql
CREATE TABLE sentiment_analysis_stats (
    id SERIAL PRIMARY KEY,
    franchise_id INTEGER NOT NULL,

    -- ê¸°ê°„
    period_type VARCHAR(20) NOT NULL,           -- daily/weekly/monthly
    period_start DATE NOT NULL,
    period_end DATE NOT NULL,

    -- ê°ì • ë¶„í¬
    positive_count INTEGER DEFAULT 0,
    negative_count INTEGER DEFAULT 0,
    neutral_count INTEGER DEFAULT 0,
    total_reviews INTEGER DEFAULT 0,

    -- í‰ê·  ê°ì • ê°•ë„
    avg_sentiment_strength DECIMAL(3,2),

    -- ì£¼ìš” ì£¼ì œ (JSON)
    top_topics TEXT,                            -- [{"topic": "ë§›/í’ˆì§ˆ", "count": 10}]
    top_keywords TEXT,                          -- [{"keyword": "ë§›ìžˆ", "count": 15}]

    -- ê³ ê° ì˜ë„ ë¶„í¬ (JSON)
    intent_distribution TEXT,                   -- {"ì¹­ì°¬": 20, "ë¶ˆë§Œ": 5}

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (franchise_id) REFERENCES franchises(id) ON DELETE CASCADE,
    UNIQUE(franchise_id, period_type, period_start)
);

-- ì¸ë±ìŠ¤
CREATE INDEX idx_sentiment_stats_franchise ON sentiment_analysis_stats(franchise_id);
CREATE INDEX idx_sentiment_stats_period ON sentiment_analysis_stats(period_type, period_start);
```

**ìžë™ ì—…ë°ì´íŠ¸ íŠ¸ë¦¬ê±°**:
```sql
CREATE OR REPLACE FUNCTION update_sentiment_stats()
RETURNS TRIGGER AS $$
BEGIN
    -- ì¼ë³„ í†µê³„ ìžë™ ì—…ë°ì´íŠ¸
    INSERT INTO sentiment_analysis_stats (
        franchise_id, period_type, period_start, period_end,
        positive_count, negative_count, neutral_count, total_reviews
    )
    VALUES (
        NEW.franchise_id, 'daily', CURRENT_DATE, CURRENT_DATE,
        CASE WHEN NEW.sentiment = 'positive' THEN 1 ELSE 0 END,
        CASE WHEN NEW.sentiment = 'negative' THEN 1 ELSE 0 END,
        CASE WHEN NEW.sentiment = 'neutral' THEN 1 ELSE 0 END,
        1
    )
    ON CONFLICT (franchise_id, period_type, period_start)
    DO UPDATE SET
        positive_count = sentiment_analysis_stats.positive_count +
            CASE WHEN NEW.sentiment = 'positive' THEN 1 ELSE 0 END,
        negative_count = sentiment_analysis_stats.negative_count +
            CASE WHEN NEW.sentiment = 'negative' THEN 1 ELSE 0 END,
        neutral_count = sentiment_analysis_stats.neutral_count +
            CASE WHEN NEW.sentiment = 'neutral' THEN 1 ELSE 0 END,
        total_reviews = sentiment_analysis_stats.total_reviews + 1,
        updated_at = CURRENT_TIMESTAMP;

    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER trigger_update_sentiment_stats
AFTER INSERT OR UPDATE OF sentiment ON reviews
FOR EACH ROW
WHEN (NEW.sentiment IS NOT NULL AND NEW.analyzed_at IS NOT NULL)
EXECUTE FUNCTION update_sentiment_stats();
```

#### 5. ai_replies (í™•ìž¥)

**ë‹µê¸€ ë©”íƒ€ë°ì´í„° ì¶”ê°€**:

```sql
ALTER TABLE ai_replies
ADD COLUMN reply_strategy VARCHAR(100),         -- 'ì§„ì‹¬ì–´ë¦° ì‚¬ê³¼ì™€ ê°œì„ '
ADD COLUMN reply_focus TEXT[],                  -- ['ëŒ€ê¸°ì‹œê°„ ê°œì„  ì•½ì†']
ADD COLUMN prompt_version VARCHAR(50) DEFAULT 'v2_sentiment_based',
ADD COLUMN generation_time_ms INTEGER,
ADD COLUMN tokens_used INTEGER;

-- ì¸ë±ìŠ¤
CREATE INDEX idx_ai_replies_strategy ON ai_replies(reply_strategy);
CREATE INDEX idx_ai_replies_franchise_date ON ai_replies(franchise_id, created_at);
```

### ë·° (Views)

#### v_sentiment_summary

**ê°€ë§¹ì ë³„ ê°ì • ë¶„ì„ ìš”ì•½**:

```sql
CREATE OR REPLACE VIEW v_sentiment_summary AS
SELECT
    f.id AS franchise_id,
    f.name AS franchise_name,
    COUNT(r.id) AS total_reviews,
    COUNT(CASE WHEN r.sentiment = 'positive' THEN 1 END) AS positive_count,
    COUNT(CASE WHEN r.sentiment = 'negative' THEN 1 END) AS negative_count,
    COUNT(CASE WHEN r.sentiment = 'neutral' THEN 1 END) AS neutral_count,
    ROUND(AVG(r.sentiment_strength), 2) AS avg_sentiment_strength,
    COUNT(CASE WHEN r.sentiment = 'negative' AND r.sentiment_strength > 0.7 THEN 1 END) AS high_priority_issues
FROM franchises f
LEFT JOIN reviews r ON f.id = r.franchise_id
WHERE r.analyzed_at IS NOT NULL
GROUP BY f.id, f.name;
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```sql
SELECT * FROM v_sentiment_summary WHERE franchise_id = 123;

-- ê²°ê³¼:
-- franchise_name | total_reviews | positive | negative | neutral | avg_strength | high_priority
-- ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì  | 150          | 98       | 32       | 20      | 0.71         | 5
```

#### v_topic_analysis

**ì£¼ì œë³„ ë¶„ì„ ìš”ì•½**:

```sql
CREATE OR REPLACE VIEW v_topic_analysis AS
SELECT
    rt.franchise_id,
    f.name AS franchise_name,
    rt.topic_name,
    rt.topic_sentiment,
    COUNT(*) AS mention_count,
    ROUND(AVG(rt.confidence), 2) AS avg_confidence
FROM review_topics rt
JOIN franchises f ON rt.franchise_id = f.id
GROUP BY rt.franchise_id, f.name, rt.topic_name, rt.topic_sentiment
ORDER BY mention_count DESC;
```

### í•¨ìˆ˜ (Functions)

#### get_sentiment_distribution

**íŠ¹ì • ê¸°ê°„ì˜ ê°ì • ë¶„í¬ ì¡°íšŒ**:

```sql
CREATE OR REPLACE FUNCTION get_sentiment_distribution(
    p_franchise_id INTEGER,
    p_days INTEGER DEFAULT 30
)
RETURNS TABLE (
    sentiment VARCHAR,
    count BIGINT,
    percentage DECIMAL
) AS $$
BEGIN
    RETURN QUERY
    SELECT
        r.sentiment,
        COUNT(*) AS count,
        ROUND((COUNT(*) * 100.0 / SUM(COUNT(*)) OVER ()), 1) AS percentage
    FROM reviews r
    WHERE r.franchise_id = p_franchise_id
      AND r.analyzed_at >= CURRENT_DATE - INTERVAL '1 day' * p_days
      AND r.sentiment IS NOT NULL
    GROUP BY r.sentiment
    ORDER BY count DESC;
END;
$$ LANGUAGE plpgsql;
```

**ì‚¬ìš© ì˜ˆì‹œ**:
```sql
SELECT * FROM get_sentiment_distribution(123, 30);

-- ê²°ê³¼:
-- sentiment | count | percentage
-- positive  | 98    | 65.3
-- negative  | 32    | 21.3
-- neutral   | 20    | 13.3
```

---

## API ë ˆí¼ëŸ°ìŠ¤

### AIServiceV2

**íŒŒì¼**: `packages/server/services/ai-service-v2.js`

#### constructor(config)

**ì´ˆê¸°í™”**:
```javascript
const AIServiceV2 = require('./services/ai-service-v2');

const aiService = new AIServiceV2({
  openaiApiKey: process.env.OPENAI_API_KEY,
  anthropicApiKey: process.env.ANTHROPIC_API_KEY,
  pool: dbPool  // PostgreSQL ì—°ê²° í’€ (ì˜µì…˜)
});
```

#### generateReply(reviewContent, options)

**ë‹µê¸€ ìƒì„± (ë¶„ì„ í¬í•¨)**:

```javascript
const result = await aiService.generateReply(
  "ì»¤í”¼ê°€ ë§›ìžˆê³  ì§ì›ì´ ì¹œì ˆí•´ìš”!",
  {
    // í•„ìˆ˜
    brandContext: 'ì¹´íŽ˜',              // ë§¤ìž¥ ìœ í˜•

    // ì„ íƒ
    franchiseName: 'ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì ',   // ë§¤ìž¥ëª…
    franchiseId: 123,                  // ê°€ë§¹ì  ID
    model: 'gpt-4o-mini',              // AI ëª¨ë¸
    saveToDb: true,                    // DB ì €ìž¥ ì—¬ë¶€

    // í•˜ìœ„ í˜¸í™˜ (deprecated)
    rating: 5                          // ë¬´ì‹œë¨
  }
);

// ë°˜í™˜ê°’
{
  success: true,
  reply: "ì»¤í”¼ ë§›ìžˆê²Œ ë“œì…¨ë‹¤ë‹ˆ ê¸°ì©ë‹ˆë‹¤ ðŸ˜Š...",
  sentiment: 'positive',
  sentiment_strength: 0.85,
  topics: ['ë§›/í’ˆì§ˆ', 'ì„œë¹„ìŠ¤'],
  keywords: ['ë§›ìžˆ', 'ì¹œì ˆ', 'ì»¤í”¼'],
  intent: 'ì¹­ì°¬',
  metadata: {
    model: 'gpt-4o-mini',
    total_time_ms: 1245,
    analysis_time_ms: 842,
    generation_time_ms: 403,
    tokens_used: 342,
    source: 'ai'  // 'ai' | 'cache' | 'template'
  }
}
```

#### analyzeSentiment(reviewContent, options)

**ê°ì • ë¶„ì„ë§Œ ìˆ˜í–‰**:

```javascript
const analysis = await aiService.analyzeSentiment(
  "ìŒì‹ì€ ê´œì°®ì€ë° ëŒ€ê¸°ì‹œê°„ì´ ë„ˆë¬´ ê¸¸ì–´ìš”",
  {
    saveToDb: true,
    franchiseId: 123
  }
);

// ë°˜í™˜ê°’
{
  success: true,
  sentiment: 'neutral',
  sentiment_strength: 0.6,
  topics: ['ë§›/í’ˆì§ˆ', 'ëŒ€ê¸°ì‹œê°„'],
  keywords: ['ìŒì‹', 'ê´œì°®', 'ëŒ€ê¸°', 'ê¸¸'],
  intent: 'ì œì•ˆ',
  reply_focus: ['ëŒ€ê¸°ì‹œê°„ ê°œì„  ì•½ì†'],
  reply_avoid: ['ë³€ëª…'],
  summary: 'ìŒì‹ ê´œì°®ìœ¼ë‚˜ ëŒ€ê¸°ì‹œê°„ ë¶ˆë§Œ',
  analysis_depth: 'deep',
  analysis_source: 'ai',
  model_used: 'gpt-4o-mini',
  analysis_time_ms: 842
}
```

#### processBatch(reviews, options)

**ë°°ì¹˜ ì²˜ë¦¬ (ì—¬ëŸ¬ ë¦¬ë·° í•œë²ˆì—)**:

```javascript
const reviews = [
  { id: 1, content: "ë§›ìžˆì–´ìš”!", brandContext: "ì¹´íŽ˜" },
  { id: 2, content: "ë¶ˆì¹œì ˆí•´ìš”", brandContext: "ìŒì‹ì " },
  { id: 3, content: "ê°€ê²©ì´ ë¹„ì‹¸ìš”", brandContext: "ì¹´íŽ˜" }
];

const results = await aiService.processBatch(reviews, {
  franchiseId: 123,
  model: 'gpt-4o-mini',
  saveToDb: true,
  batchSize: 5,          // í•œ ë²ˆì— 5ê°œì”© ì²˜ë¦¬
  delayMs: 200           // ë°°ì¹˜ ê°„ 200ms ëŒ€ê¸°
});

// ë°˜í™˜ê°’: ë°°ì—´
[
  {
    review_id: 1,
    review_content: "ë§›ìžˆì–´ìš”!",
    success: true,
    reply: "...",
    sentiment: 'positive',
    analysis: {...},
    metadata: {...}
  },
  ...
]
```

#### getAnalysisStats(franchiseId, days)

**í†µê³„ ì¡°íšŒ**:

```javascript
const stats = await aiService.getAnalysisStats(123, 30);

// ë°˜í™˜ê°’
{
  by_sentiment: [
    { sentiment: 'positive', count: '98', avg_strength: '0.78' },
    { sentiment: 'neutral', count: '20', avg_strength: '0.52' },
    { sentiment: 'negative', count: '32', avg_strength: '0.71' }
  ],
  total: 150
}
```

#### getUsageStats()

**API ì‚¬ìš©ëŸ‰ ì¡°íšŒ**:

```javascript
const usage = aiService.getUsageStats();

// ë°˜í™˜ê°’
{
  reply_generator: {
    analysis: { requests: 45, tokens: 12500, errors: 2 },
    generation: { requests: 43, tokens: 8900, errors: 1 },
    template: { requests: 3 }
  }
}
```

### SentimentAnalyzer

**íŒŒì¼**: `packages/server/services/sentiment-analyzer.js`

#### analyze(content)

**ë‹¨ì¼ ë¦¬ë·° ë¶„ì„**:

```javascript
const SentimentAnalyzer = require('./services/sentiment-analyzer');

const analyzer = new SentimentAnalyzer({
  openaiApiKey: process.env.OPENAI_API_KEY
});

const analysis = await analyzer.analyze("ì»¤í”¼ ë§›ìžˆì–´ìš”");

// ë°˜í™˜ê°’: ìƒì„¸ ë¶„ì„ ê²°ê³¼ (ìœ„ì˜ analyzeSentimentì™€ ë™ì¼)
```

#### analyzeBatch(reviews, options)

**ë°°ì¹˜ ë¶„ì„**:

```javascript
const reviews = [
  { id: 1, content: "ë§›ìžˆì–´ìš”" },
  { id: 2, content: "ë³„ë¡œì˜ˆìš”" }
];

const results = await analyzer.analyzeBatch(reviews, {
  batchSize: 10,
  delayMs: 100
});
```

### AIReplyGenerator

**íŒŒì¼**: `packages/server/services/ai-reply-generator.js`

#### generateReply(reviewContent, options)

**ë‹µê¸€ ìƒì„± (ë¶„ì„ ê°ì²´ ì „ë‹¬)**:

```javascript
const AIReplyGenerator = require('./services/ai-reply-generator');

const generator = new AIReplyGenerator({
  openaiApiKey: process.env.OPENAI_API_KEY
});

// ë¶„ì„ ê²°ê³¼ë¥¼ ë¯¸ë¦¬ ë°›ì€ ê²½ìš°
const analysis = await analyzer.analyze(content);

const result = await generator.generateReply(content, {
  brandContext: 'ì¹´íŽ˜',
  analysis: analysis,      // ë¶„ì„ ê²°ê³¼ ì „ë‹¬
  skipAnalysis: true       // ë¶„ì„ ìŠ¤í‚µ
});
```

---

## êµ¬í˜„ ì˜ˆì œ

### ì˜ˆì œ 1: ê¸°ë³¸ ë‹µê¸€ ìƒì„±

```javascript
// server/routes/reply-routes.js

const express = require('express');
const router = express.Router();
const AIServiceV2 = require('../services/ai-service-v2');

// AI ì„œë¹„ìŠ¤ ì´ˆê¸°í™”
const aiService = new AIServiceV2({
  openaiApiKey: process.env.OPENAI_API_KEY,
  anthropicApiKey: process.env.ANTHROPIC_API_KEY,
  pool: require('../database/pool')
});

/**
 * POST /api/v2/replies/generate
 * ë‹µê¸€ ìƒì„± API
 */
router.post('/generate', async (req, res) => {
  try {
    const {
      reviewContent,
      brandContext,
      franchiseName,
      franchiseId
    } = req.body;

    // ìž…ë ¥ ê²€ì¦
    if (!reviewContent || !brandContext) {
      return res.status(400).json({
        success: false,
        error: 'reviewContentì™€ brandContextëŠ” í•„ìˆ˜ìž…ë‹ˆë‹¤.'
      });
    }

    // ë‹µê¸€ ìƒì„±
    const result = await aiService.generateReply(reviewContent, {
      brandContext,
      franchiseName,
      franchiseId,
      model: 'gpt-4o-mini',
      saveToDb: true
    });

    res.json(result);

  } catch (error) {
    console.error('ë‹µê¸€ ìƒì„± ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});

module.exports = router;
```

**ì‚¬ìš©ë²•**:
```bash
curl -X POST http://localhost:4512/api/v2/replies/generate \
  -H "Content-Type: application/json" \
  -d '{
    "reviewContent": "ì»¤í”¼ê°€ ë§›ìžˆê³  ì§ì›ì´ ì¹œì ˆí•´ìš”!",
    "brandContext": "ì¹´íŽ˜",
    "franchiseName": "ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì ",
    "franchiseId": 123
  }'
```

### ì˜ˆì œ 2: ê°ì • ë¶„ì„ë§Œ ìˆ˜í–‰

```javascript
/**
 * POST /api/v2/analysis/sentiment
 * ê°ì • ë¶„ì„ API
 */
router.post('/sentiment', async (req, res) => {
  try {
    const { reviewContent, franchiseId } = req.body;

    if (!reviewContent) {
      return res.status(400).json({
        success: false,
        error: 'reviewContentëŠ” í•„ìˆ˜ìž…ë‹ˆë‹¤.'
      });
    }

    const analysis = await aiService.analyzeSentiment(reviewContent, {
      saveToDb: true,
      franchiseId
    });

    res.json(analysis);

  } catch (error) {
    console.error('ê°ì • ë¶„ì„ ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});
```

### ì˜ˆì œ 3: ë°°ì¹˜ ì²˜ë¦¬

```javascript
/**
 * POST /api/v2/replies/batch
 * ë°°ì¹˜ ë‹µê¸€ ìƒì„± API
 */
router.post('/batch', async (req, res) => {
  try {
    const { reviews, franchiseId, brandContext } = req.body;

    if (!Array.isArray(reviews) || reviews.length === 0) {
      return res.status(400).json({
        success: false,
        error: 'reviews ë°°ì—´ì€ í•„ìˆ˜ì´ë©° ë¹„ì–´ìžˆì§€ ì•Šì•„ì•¼ í•©ë‹ˆë‹¤.'
      });
    }

    // ë°°ì¹˜ ì²˜ë¦¬
    const results = await aiService.processBatch(reviews, {
      franchiseId,
      brandContext,
      model: 'gpt-4o-mini',
      saveToDb: true,
      batchSize: 10,
      delayMs: 200
    });

    res.json({
      success: true,
      total: results.length,
      results
    });

  } catch (error) {
    console.error('ë°°ì¹˜ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});
```

### ì˜ˆì œ 4: í†µê³„ ì¡°íšŒ

```javascript
/**
 * GET /api/v2/analysis/stats/:franchiseId
 * ê°ì • ë¶„ì„ í†µê³„ API
 */
router.get('/stats/:franchiseId', async (req, res) => {
  try {
    const { franchiseId } = req.params;
    const { days = 30 } = req.query;

    // ê°ì • ë¶„í¬
    const distribution = await aiService.getAnalysisStats(
      parseInt(franchiseId),
      parseInt(days)
    );

    // ì£¼ì œë³„ ë¶„ì„
    const pool = req.app.locals.pool;
    const topicStats = await pool.query(`
      SELECT
        topic_name,
        topic_sentiment,
        COUNT(*) as count
      FROM review_topics
      WHERE franchise_id = $1
        AND created_at >= CURRENT_DATE - INTERVAL '1 day' * $2
      GROUP BY topic_name, topic_sentiment
      ORDER BY count DESC
      LIMIT 10
    `, [franchiseId, days]);

    res.json({
      success: true,
      period_days: parseInt(days),
      sentiment_distribution: distribution,
      top_topics: topicStats.rows
    });

  } catch (error) {
    console.error('í†µê³„ ì¡°íšŒ ì˜¤ë¥˜:', error);
    res.status(500).json({
      success: false,
      error: error.message
    });
  }
});
```

### ì˜ˆì œ 5: ë°ìŠ¤í¬í†± ì•± í†µí•©

```javascript
// packages/desktop-app/src/review-manager-v2.js

const AIClient = require('./ai-client');
const Database = require('./database-v2');

class ReviewManagerV2 {
  constructor() {
    this.aiClient = new AIClient();
    this.database = new Database();
  }

  /**
   * ë¦¬ë·° ìˆ˜ì§‘ + ë¶„ì„ + ë‹µê¸€ ìƒì„± (í†µí•© ì›Œí¬í”Œë¡œìš°)
   */
  async processReviews() {
    console.log('ðŸ“Š ë¦¬ë·° ì²˜ë¦¬ ì‹œìž‘...');

    // 1. ë¦¬ë·° ìˆ˜ì§‘
    const collectedReviews = await this.collectReviewsFromNaver();
    console.log(`âœ… ${collectedReviews.length}ê°œ ë¦¬ë·° ìˆ˜ì§‘ ì™„ë£Œ`);

    // 2. ê° ë¦¬ë·°ì— ëŒ€í•´ ë‹µê¸€ ìƒì„±
    for (const review of collectedReviews) {
      try {
        console.log(`\nì²˜ë¦¬ ì¤‘: "${review.content.substring(0, 30)}..."`);

        // ê°ì • ë¶„ì„ + ë‹µê¸€ ìƒì„± (í†µí•©)
        const result = await this.aiClient.generateReplyV2(
          review.content,
          {
            brandContext: 'ì¹´íŽ˜',
            franchiseName: 'ìš°ë¦¬ ë§¤ìž¥'
          }
        );

        if (result.success) {
          // DB ì €ìž¥
          await this.database.saveReviewWithAnalysis({
            ...review,
            sentiment: result.sentiment,
            sentiment_strength: result.sentiment_strength,
            sentiment_keywords: JSON.stringify(result.keywords),
            sentiment_topics: JSON.stringify(result.topics),
            customer_intent: result.intent,
            generated_reply: result.reply,
            reply_model: result.metadata.model
          });

          console.log(`âœ… ë‹µê¸€ ìƒì„±: "${result.reply}"`);
          console.log(`   ê°ì •: ${result.sentiment} (${(result.sentiment_strength * 100).toFixed(0)}%)`);
        }

      } catch (error) {
        console.error(`âŒ ë¦¬ë·° ì²˜ë¦¬ ì‹¤íŒ¨:`, error.message);
      }

      // Rate limiting
      await this.sleep(500);
    }

    console.log('\nâœ… ëª¨ë“  ë¦¬ë·° ì²˜ë¦¬ ì™„ë£Œ');
  }

  sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }
}

module.exports = ReviewManagerV2;
```

### ì˜ˆì œ 6: ì›¹ ëŒ€ì‹œë³´ë“œ ì°¨íŠ¸

```javascript
// packages/web-dashboard/pages/analytics/sentiment.tsx

import { useEffect, useState } from 'react';
import { Doughnut, Bar } from 'react-chartjs-2';
import { getSentimentStats } from '../../lib/api';

export default function SentimentAnalytics() {
  const [stats, setStats] = useState(null);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    loadStats();
  }, []);

  const loadStats = async () => {
    try {
      const franchiseId = 123; // ì˜ˆì‹œ
      const data = await getSentimentStats(franchiseId, 30);
      setStats(data);
    } catch (error) {
      console.error('í†µê³„ ë¡œë“œ ì‹¤íŒ¨:', error);
    } finally {
      setLoading(false);
    }
  };

  if (loading) return <div>ë¡œë”© ì¤‘...</div>;
  if (!stats) return <div>ë°ì´í„° ì—†ìŒ</div>;

  // ê°ì • ë¶„í¬ ì°¨íŠ¸ ë°ì´í„°
  const sentimentData = {
    labels: ['ê¸ì •', 'ë¶€ì •', 'ì¤‘ë¦½'],
    datasets: [{
      data: [
        stats.sentiment_distribution.by_sentiment.find(s => s.sentiment === 'positive')?.count || 0,
        stats.sentiment_distribution.by_sentiment.find(s => s.sentiment === 'negative')?.count || 0,
        stats.sentiment_distribution.by_sentiment.find(s => s.sentiment === 'neutral')?.count || 0
      ],
      backgroundColor: ['#10b981', '#ef4444', '#6b7280']
    }]
  };

  // ì£¼ì œë³„ ì°¨íŠ¸ ë°ì´í„°
  const topicData = {
    labels: stats.top_topics.map(t => t.topic_name),
    datasets: [{
      label: 'ì–¸ê¸‰ íšŸìˆ˜',
      data: stats.top_topics.map(t => parseInt(t.count)),
      backgroundColor: '#3b82f6'
    }]
  };

  return (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-6">ê°ì • ë¶„ì„</h1>

      <div className="grid grid-cols-2 gap-6">
        {/* ê°ì • ë¶„í¬ */}
        <div className="bg-white p-6 rounded-lg shadow">
          <h2 className="text-lg font-semibold mb-4">ê°ì • ë¶„í¬</h2>
          <Doughnut data={sentimentData} />
        </div>

        {/* ì£¼ì œë³„ ì–¸ê¸‰ */}
        <div className="bg-white p-6 rounded-lg shadow">
          <h2 className="text-lg font-semibold mb-4">ì£¼ìš” ì£¼ì œ</h2>
          <Bar data={topicData} />
        </div>
      </div>

      {/* í†µê³„ ìš”ì•½ */}
      <div className="mt-6 bg-white p-6 rounded-lg shadow">
        <h2 className="text-lg font-semibold mb-4">í†µê³„ ìš”ì•½</h2>
        <div className="grid grid-cols-3 gap-4">
          <div>
            <div className="text-sm text-gray-500">ì´ ë¦¬ë·°</div>
            <div className="text-2xl font-bold">{stats.sentiment_distribution.total}</div>
          </div>
          <div>
            <div className="text-sm text-gray-500">ê¸ì • ë¹„ìœ¨</div>
            <div className="text-2xl font-bold text-green-600">
              {((stats.sentiment_distribution.by_sentiment.find(s => s.sentiment === 'positive')?.count || 0) /
                stats.sentiment_distribution.total * 100).toFixed(1)}%
            </div>
          </div>
          <div>
            <div className="text-sm text-gray-500">ë¶€ì • ë¹„ìœ¨</div>
            <div className="text-2xl font-bold text-red-600">
              {((stats.sentiment_distribution.by_sentiment.find(s => s.sentiment === 'negative')?.count || 0) /
                stats.sentiment_distribution.total * 100).toFixed(1)}%
            </div>
          </div>
        </div>
      </div>
    </div>
  );
}
```

---

## ì„±ëŠ¥ ìµœì í™”

### 1. ìºì‹± ì „ëžµ

#### ë¶„ì„ ê²°ê³¼ ìºì‹±

**ëª©ì **: ë™ì¼í•˜ê±°ë‚˜ ìœ ì‚¬í•œ ë¦¬ë·°ì˜ ì¤‘ë³µ ë¶„ì„ ë°©ì§€

**êµ¬í˜„**:
```javascript
// 1. SHA-256 í•´ì‹œ ê¸°ë°˜ ìºì‹œ í‚¤ ìƒì„±
const crypto = require('crypto');
const contentHash = crypto.createHash('sha256')
  .update(reviewContent.trim().toLowerCase())
  .digest('hex');

// 2. ìºì‹œ ì¡°íšŒ
const cached = await pool.query(
  'SELECT * FROM sentiment_analysis_cache WHERE content_hash = $1',
  [contentHash]
);

if (cached.rows.length > 0) {
  // ìºì‹œ ížˆíŠ¸ - ì¦‰ì‹œ ë°˜í™˜
  await pool.query(
    'UPDATE sentiment_analysis_cache SET hit_count = hit_count + 1, last_used_at = NOW() WHERE content_hash = $1',
    [contentHash]
  );
  return cached.rows[0];
}

// 3. ìºì‹œ ë¯¸ìŠ¤ - ìƒˆë¡œ ë¶„ì„
const analysis = await analyzer.analyze(reviewContent);

// 4. ìºì‹œ ì €ìž¥
await pool.query(
  'INSERT INTO sentiment_analysis_cache (...) VALUES (...) ON CONFLICT DO NOTHING',
  [contentHash, ...]
);
```

**íš¨ê³¼**:
- ë™ì¼ ë¦¬ë·°: **100% API ë¹„ìš© ì ˆê°**
- ìœ ì‚¬ ë¦¬ë·° (ì˜ˆ: "ë§›ìžˆì–´ìš”" vs "ë§›ìžˆì–´ìš”!"): **95% ì ˆê°**
- í‰ê·  ížˆíŠ¸ìœ¨: **30~40%** (ê°€ë§¹ì  ê·œëª¨ì— ë”°ë¼ ìƒì´)

#### ìºì‹œ ë§Œë£Œ ì •ì±…

```javascript
// ì˜¤ëž˜ëœ ìºì‹œ ì •ë¦¬ (ë§¤ì¼ ì‹¤í–‰)
DELETE FROM sentiment_analysis_cache
WHERE last_used_at < NOW() - INTERVAL '90 days'
  AND hit_count < 2;  -- 2íšŒ ë¯¸ë§Œ ì‚¬ìš©ëœ ìºì‹œë§Œ ì‚­ì œ
```

### 2. ì¡°ê±´ë¶€ AI ë¶„ì„

**ëª©ì **: ê°„ë‹¨í•œ ë¦¬ë·°ëŠ” ë£° ê¸°ë°˜ ì²˜ë¦¬ë¡œ AI ë¹„ìš© ì ˆê°

**ë¶„ì„ ê¹Šì´ ê²°ì • ë¡œì§**:
```javascript
// ë³µìž¡ë„ í‰ê°€
const needsDeepAnalysis =
  quickSentiment === 'negative' ||        // ë¶€ì • ë¦¬ë·°ëŠ” í•­ìƒ ì •ë°€ ë¶„ì„
  content.length > 100 ||                 // ê¸´ ë¦¬ë·° (ë³µìž¡ë„ ë†’ìŒ)
  topicResult.topics.length > 2 ||        // ì—¬ëŸ¬ ì£¼ì œ ì–¸ê¸‰
  quickConfidence < 0.7 ||                // ë‚®ì€ ì‹ ë¢°ë„
  topicResult.issues.length > 0;          // ì´ìŠˆ ê°ì§€ë¨

if (needsDeepAnalysis && hasApiKey) {
  // AI ì •ë°€ ë¶„ì„
  return await this.deepAnalysisWithAI(content, quickResult, topicResult);
} else {
  // ë£° ê¸°ë°˜ ê²°ê³¼ ì‚¬ìš© (ë¬´ë£Œ)
  return this.buildFallbackAnalysis(content, quickResult, topicResult);
}
```

**ë¹„ìš© ì ˆê° íš¨ê³¼**:
| ë¦¬ë·° ìœ í˜• | ë¹„ìœ¨ | AI ì‚¬ìš© | ì ˆê° |
|----------|------|---------|------|
| ê°„ë‹¨í•œ ê¸ì • | 40% | 0% | 100% |
| ë³µìž¡í•œ ë¦¬ë·° | 35% | 100% | 0% |
| ë¶€ì • ë¦¬ë·° | 25% | 100% | 0% |
| **í‰ê· ** | **100%** | **60%** | **40%** |

### 3. ë°°ì¹˜ ì²˜ë¦¬ ìµœì í™”

**Rate Limiting ê³ ë ¤**:
```javascript
// GPT-4o-mini: 500 RPM (ë¶„ë‹¹ ìš”ì²­ ì œí•œ)
const batchSize = 10;           // ë™ì‹œ ì²˜ë¦¬ ìˆ˜
const delayMs = 150;            // ë°°ì¹˜ ê°„ ëŒ€ê¸° ì‹œê°„

// ê³„ì‚°: 1000ms / 150ms Ã— 10 = 66.7ê°œ/ì´ˆ = 4000ê°œ/ë¶„
// â†’ 500 RPM ì œí•œ ë‚´ì—ì„œ ì•ˆì „
```

**ë°°ì¹˜ ì²˜ë¦¬ ì˜ˆì‹œ**:
```javascript
async function processBatchOptimized(reviews) {
  const results = [];

  for (let i = 0; i < reviews.length; i += batchSize) {
    const batch = reviews.slice(i, i + batchSize);

    // ë™ì‹œ ì²˜ë¦¬
    const batchPromises = batch.map(review =>
      aiService.generateReply(review.content, options)
    );

    const batchResults = await Promise.all(batchPromises);
    results.push(...batchResults);

    // Rate limiting
    if (i + batchSize < reviews.length) {
      await sleep(delayMs);
    }

    console.log(`ì§„í–‰ë¥ : ${Math.min(i + batchSize, reviews.length)}/${reviews.length}`);
  }

  return results;
}
```

### 4. ë°ì´í„°ë² ì´ìŠ¤ ìµœì í™”

#### ì¸ë±ìŠ¤ ì „ëžµ

```sql
-- ê°ì • ê¸°ë°˜ ì¿¼ë¦¬ ìµœì í™”
CREATE INDEX idx_reviews_sentiment ON reviews(sentiment);
CREATE INDEX idx_reviews_sentiment_franchise ON reviews(franchise_id, sentiment);

-- ì‹œê°„ ê¸°ë°˜ ì¿¼ë¦¬ ìµœì í™”
CREATE INDEX idx_reviews_analyzed_at ON reviews(analyzed_at);
CREATE INDEX idx_reviews_franchise_date ON reviews(franchise_id, analyzed_at DESC);

-- ì£¼ì œ ê²€ìƒ‰ ìµœì í™”
CREATE INDEX idx_review_topics_name ON review_topics(topic_name);
CREATE INDEX idx_review_topics_franchise_topic ON review_topics(franchise_id, topic_name);

-- ìºì‹œ ì¡°íšŒ ìµœì í™”
CREATE INDEX idx_sentiment_cache_hash ON sentiment_analysis_cache(content_hash);
```

#### ì¿¼ë¦¬ ìµœì í™”

**Bad**:
```sql
-- N+1 ë¬¸ì œ
SELECT * FROM reviews WHERE franchise_id = 123;
-- ê° ë¦¬ë·°ì— ëŒ€í•´...
SELECT * FROM review_topics WHERE review_id = ?;
```

**Good**:
```sql
-- JOINìœ¼ë¡œ í•œ ë²ˆì— ì¡°íšŒ
SELECT
  r.*,
  ARRAY_AGG(rt.topic_name) as topics
FROM reviews r
LEFT JOIN review_topics rt ON r.id = rt.review_id
WHERE r.franchise_id = 123
GROUP BY r.id;
```

### 5. ë©”ëª¨ë¦¬ ê´€ë¦¬

```javascript
// ëŒ€ëŸ‰ ë°°ì¹˜ ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ íš¨ìœ¨í™”
async function processMassiveReviews(reviews) {
  const chunkSize = 100;  // 100ê°œì”© ì²˜ë¦¬

  for (let i = 0; i < reviews.length; i += chunkSize) {
    const chunk = reviews.slice(i, i + chunkSize);
    await processChunk(chunk);

    // ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ížŒíŠ¸
    if (global.gc && i % 500 === 0) {
      global.gc();
    }
  }
}
```

---

## ë¹„ìš© ë¶„ì„

### API ë¹„ìš© êµ¬ì¡°

#### OpenAI GPT-4o-mini ê°€ê²©

| í•­ëª© | ê°€ê²© |
|-----|------|
| Input | $0.150 / 1M tokens |
| Output | $0.600 / 1M tokens |

#### í† í° ì‚¬ìš©ëŸ‰ ì¶”ì •

**ê°ì • ë¶„ì„ (1íšŒ)**:
- ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸: ~150 tokens
- ë¦¬ë·° ë‚´ìš© (í‰ê· ): ~50 tokens
- ì¶œë ¥ (JSON): ~100 tokens
- **ì´**: ~300 tokens
- **ë¹„ìš©**: ~$0.0001

**ë‹µê¸€ ìƒì„± (1íšŒ)**:
- ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸: ~200 tokens
- ë¶„ì„ ê²°ê³¼ + ë¦¬ë·°: ~200 tokens
- ê°€ì´ë“œë¼ì¸: ~300 tokens
- ì¶œë ¥ (ë‹µê¸€): ~50 tokens
- **ì´**: ~750 tokens
- **ë¹„ìš©**: ~$0.0003

**í†µí•© ì²˜ë¦¬ (ë¶„ì„ + ìƒì„±)**:
- **ì´ í† í°**: ~1050 tokens
- **ì´ ë¹„ìš©**: ~$0.0004

### ì‹¤ì œ ë¹„ìš© ì‹œë®¬ë ˆì´ì…˜

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ì†Œê·œëª¨ ê°€ë§¹ì  (ì›” 100ê°œ ë¦¬ë·°)

```
ë¦¬ë·° ë¶„ë¥˜:
- ê°„ë‹¨í•œ ê¸ì • (40ê°œ): ë£° ê¸°ë°˜ ì²˜ë¦¬ â†’ $0
- ë³µìž¡í•œ ê¸ì • (30ê°œ): AI ë¶„ì„ + ìƒì„±
  * ìµœì´ˆ ì²˜ë¦¬: 30 Ã— $0.0004 = $0.012
  * ìºì‹œ ížˆíŠ¸ (30%): 9ê°œ â†’ $0.003 ì ˆì•½
  * ì‹¤ì œ: $0.009
- ì¤‘ë¦½ (20ê°œ): AI ë¶„ì„ + ìƒì„±
  * ìºì‹œ ížˆíŠ¸ (20%): 4ê°œ â†’ $0.002 ì ˆì•½
  * ì‹¤ì œ: $0.006
- ë¶€ì • (10ê°œ): í•­ìƒ AI ë¶„ì„ + ìƒì„±
  * ì‹¤ì œ: 10 Ã— $0.0004 = $0.004

ì›” ì´ ë¹„ìš©: $0.019 â‰ˆ $0.02
```

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ì¤‘ê·œëª¨ ê°€ë§¹ì  (ì›” 500ê°œ ë¦¬ë·°)

```
ë¦¬ë·° ë¶„ë¥˜:
- ê°„ë‹¨í•œ ê¸ì • (200ê°œ): $0
- ë³µìž¡í•œ ê¸ì • (150ê°œ): $0.045 (ìºì‹œ 30% ê³ ë ¤)
- ì¤‘ë¦½ (100ê°œ): $0.032 (ìºì‹œ 20% ê³ ë ¤)
- ë¶€ì • (50ê°œ): $0.020

ì›” ì´ ë¹„ìš©: $0.097 â‰ˆ $0.10
```

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ëŒ€ê·œëª¨ ê°€ë§¹ì  (ì›” 2000ê°œ ë¦¬ë·°)

```
ë¦¬ë·° ë¶„ë¥˜:
- ê°„ë‹¨í•œ ê¸ì • (800ê°œ): $0
- ë³µìž¡í•œ ê¸ì • (600ê°œ): $0.168 (ìºì‹œ 40% ê³ ë ¤)
- ì¤‘ë¦½ (400ê°œ): $0.128 (ìºì‹œ 25% ê³ ë ¤)
- ë¶€ì • (200ê°œ): $0.080

ì›” ì´ ë¹„ìš©: $0.376 â‰ˆ $0.38
```

### ë¹„ìš© ë¹„êµ: v1 vs v2

| í•­ëª© | v1 (í‰ì  ê¸°ë°˜) | v2 (ê°ì • ê¸°ë°˜) | ì ˆê°ë¥  |
|-----|--------------|--------------|-------|
| API í˜¸ì¶œ | 1íšŒ/ë¦¬ë·° | 0~2íšŒ/ë¦¬ë·° (í‰ê·  1.2íšŒ) | -20% |
| ê°„ë‹¨í•œ ë¦¬ë·° | AI ì‚¬ìš© | ë£° ê¸°ë°˜ (ë¬´ë£Œ) | 100% |
| ìºì‹± | ì—†ìŒ | ìžˆìŒ (30~40% ížˆíŠ¸) | 30~40% |
| **í‰ê·  ë¹„ìš©** | **$0.0004/ë¦¬ë·°** | **$0.00024/ë¦¬ë·°** | **40%** |

### ë¹„ìš© ìµœì í™” íŒ

1. **ìºì‹± í™œì„±í™”**: `saveToDb: true` ì‚¬ìš©
2. **ë°°ì¹˜ ì²˜ë¦¬**: ëŒ€ëŸ‰ ë¦¬ë·°ëŠ” ë°°ì¹˜ API ì‚¬ìš©
3. **ëª¨ë¸ ì„ íƒ**: Claude Haiku ($0.00025/1K tokens)ê°€ GPT-4o-minië³´ë‹¤ ì €ë ´
4. **ì„ íƒì  ë¶„ì„**: ê¸ì • ë¦¬ë·°ëŠ” ê°„ë‹¨ížˆ ì²˜ë¦¬

---

## ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ

### 1. ì‚¬ì „ ì¤€ë¹„

#### ë°±ì—…

```bash
# PostgreSQL ë°±ì—…
pg_dump -U franchise_admin -d franchise_reviews > backup_$(date +%Y%m%d).sql

# SQLite ë°±ì—… (ë°ìŠ¤í¬í†± ì•±)
cp data/franchise.db data/franchise_backup_$(date +%Y%m%d).db
```

#### í™˜ê²½ ë³€ìˆ˜ í™•ì¸

```bash
# .env íŒŒì¼
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...  # ì„ íƒì‚¬í•­
DB_HOST=localhost
DB_PORT=5432
DB_NAME=franchise_reviews
DB_USER=franchise_admin
DB_PASSWORD=your_password
```

### 2. ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

```bash
# v11 ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
psql -U franchise_admin -d franchise_reviews -f database/migrations/v11_sentiment_analysis_enhancement.sql
```

**ë§ˆì´ê·¸ë ˆì´ì…˜ ë‚´ìš©**:
1. `reviews` í…Œì´ë¸”ì— ê°ì • ë¶„ì„ ì»¬ëŸ¼ ì¶”ê°€
2. `sentiment_analysis_cache` í…Œì´ë¸” ìƒì„±
3. `review_topics` í…Œì´ë¸” ìƒì„±
4. `sentiment_analysis_stats` í…Œì´ë¸” ìƒì„±
5. ì¸ë±ìŠ¤ ìƒì„±
6. ë·° ìƒì„±
7. íŠ¸ë¦¬ê±° ìƒì„±
8. ê¸°ì¡´ `rating` ë°ì´í„°ë¥¼ `sentiment`ë¡œ ë³€í™˜

**ê²€ì¦**:
```sql
-- ìƒˆ ì»¬ëŸ¼ í™•ì¸
\d reviews

-- ë³€í™˜ëœ ë°ì´í„° í™•ì¸
SELECT
  rating,
  sentiment,
  sentiment_strength
FROM reviews
WHERE sentiment IS NOT NULL
LIMIT 10;

-- í†µê³„ í™•ì¸
SELECT
  sentiment,
  COUNT(*)
FROM reviews
WHERE sentiment IS NOT NULL
GROUP BY sentiment;
```

### 3. ì½”ë“œ ë§ˆì´ê·¸ë ˆì´ì…˜

#### Step 1: ì˜ì¡´ì„± ì„¤ì¹˜

```bash
cd packages/server
npm install
```

#### Step 2: ì„œë¹„ìŠ¤ êµì²´

**Before (v1)**:
```javascript
// packages/server/index.js
const AIService = require('./services/ai-service');
const aiService = new AIService();
```

**After (v2)**:
```javascript
// packages/server/index.js
const AIServiceV2 = require('./services/ai-service-v2');
const aiService = new AIServiceV2({
  openaiApiKey: process.env.OPENAI_API_KEY,
  anthropicApiKey: process.env.ANTHROPIC_API_KEY,
  pool: pool  // DB ì—°ê²° ì¶”ê°€
});

// app.localsì— ì €ìž¥ (ë¼ìš°íŠ¸ì—ì„œ ì ‘ê·¼)
app.locals.aiService = aiService;
```

#### Step 3: API ì—”ë“œí¬ì¸íŠ¸ ì—…ë°ì´íŠ¸

**Before (v1)**:
```javascript
router.post('/generate-reply', async (req, res) => {
  const { reviewContent, rating, brandContext } = req.body;

  const reply = await aiService.generateReply(
    reviewContent,
    rating,
    brandContext
  );

  res.json({ reply });
});
```

**After (v2)**:
```javascript
router.post('/generate-reply', async (req, res) => {
  const {
    reviewContent,
    brandContext,
    franchiseId,
    rating  // deprecated, but still accepted
  } = req.body;

  const result = await req.app.locals.aiService.generateReply(
    reviewContent,
    {
      brandContext,
      franchiseId,
      saveToDb: true,  // ìºì‹± ë° DB ì €ìž¥
      rating  // í•˜ìœ„ í˜¸í™˜ì„± (ë‚´ë¶€ì ìœ¼ë¡œ ë¬´ì‹œë¨)
    }
  );

  res.json(result);
  // {
  //   success: true,
  //   reply: "...",
  //   sentiment: "positive",
  //   topics: [...],
  //   keywords: [...],
  //   metadata: {...}
  // }
});
```

#### Step 4: ë°ìŠ¤í¬í†± ì•± ì—…ë°ì´íŠ¸

**ìƒˆ íŒŒì¼ ì¶”ê°€**:
```javascript
// packages/desktop-app/src/ai-client-v2.js
const fetch = require('node-fetch');

class AIClientV2 {
  async generateReply(reviewContent, options = {}) {
    // ì„œë²„ API í˜¸ì¶œ
    const response = await fetch(`${this.serverUrl}/api/v2/replies/generate`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        reviewContent,
        ...options
      })
    });

    return await response.json();
  }
}

module.exports = AIClientV2;
```

**ê¸°ì¡´ ì½”ë“œ ìˆ˜ì •**:
```javascript
// packages/desktop-app/main.js
const AIClientV2 = require('./src/ai-client-v2');

class FranchiseReviewApp {
  constructor() {
    this.aiClient = new AIClientV2();  // v2 ì‚¬ìš©
  }

  async generateReply(review) {
    const result = await this.aiClient.generateReply(review.content, {
      brandContext: this.franchiseInfo.brand_context,
      franchiseName: this.franchiseInfo.name
      // rating íŒŒë¼ë¯¸í„° ì œê±°
    });

    return result;
  }
}
```

### 4. ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜ (ì¶”ì²œ)

**ì˜µì…˜ 1: Soft Migration**
```javascript
// ë‘ ë²„ì „ ë™ì‹œ ìš´ì˜
const AIService = require('./services/ai-service');  // v1
const AIServiceV2 = require('./services/ai-service-v2');  // v2

const aiServiceV1 = new AIService();
const aiServiceV2 = new AIServiceV2({ pool });

// í”Œëž˜ê·¸ë¡œ ì œì–´
const USE_V2 = process.env.USE_AI_V2 === 'true';

router.post('/generate-reply', async (req, res) => {
  const service = USE_V2 ? aiServiceV2 : aiServiceV1;

  if (USE_V2) {
    // v2 í˜¸ì¶œ
    const result = await service.generateReply(...);
    res.json(result);
  } else {
    // v1 í˜¸ì¶œ (í•˜ìœ„ í˜¸í™˜)
    const reply = await service.generateReply(...);
    res.json({ reply });
  }
});
```

**ì˜µì…˜ 2: A/B Testing**
```javascript
// íŠ¹ì • ê°€ë§¹ì ë§Œ v2 ì‚¬ìš©
const useV2ForFranchise = (franchiseId) => {
  const v2Franchises = [1, 2, 5, 10];  // í…ŒìŠ¤íŠ¸ ê°€ë§¹ì 
  return v2Franchises.includes(franchiseId);
};

router.post('/generate-reply', async (req, res) => {
  const { franchiseId } = req.body;

  const service = useV2ForFranchise(franchiseId) ? aiServiceV2 : aiServiceV1;
  // ...
});
```

### 5. í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
cd packages/server
node test-sentiment-system.js

# í†µí•© í…ŒìŠ¤íŠ¸
npm run test:integration

# E2E í…ŒìŠ¤íŠ¸
npm run test:e2e
```

**ìˆ˜ë™ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸**:
- [ ] ê¸ì • ë¦¬ë·° ë‹µê¸€ ìƒì„± ì •ìƒ ìž‘ë™
- [ ] ë¶€ì • ë¦¬ë·° ë‹µê¸€ ìƒì„± ì •ìƒ ìž‘ë™
- [ ] ì¤‘ë¦½ ë¦¬ë·° ë‹µê¸€ ìƒì„± ì •ìƒ ìž‘ë™
- [ ] ê°ì • ë¶„ì„ ê²°ê³¼ê°€ DBì— ì €ìž¥ë¨
- [ ] ìºì‹œê°€ ì •ìƒ ìž‘ë™í•¨ (2ë²ˆì§¸ ìš”ì²­ ì‹œ ë¹ ë¦„)
- [ ] ë°°ì¹˜ ì²˜ë¦¬ ì •ìƒ ìž‘ë™
- [ ] í†µê³„ API ì •ìƒ ìž‘ë™
- [ ] ëŒ€ì‹œë³´ë“œ ì°¨íŠ¸ í‘œì‹œ ì •ìƒ
- [ ] ë°ìŠ¤í¬í†± ì•± ì—°ë™ ì •ìƒ

### 6. ëª¨ë‹ˆí„°ë§

```javascript
// ì‚¬ìš©ëŸ‰ ë¡œê¹…
setInterval(() => {
  const stats = aiService.getUsageStats();
  console.log('AI ì‚¬ìš©ëŸ‰:', JSON.stringify(stats, null, 2));
}, 3600000);  // 1ì‹œê°„ë§ˆë‹¤
```

```sql
-- ì¼ì¼ í†µê³„ í™•ì¸
SELECT
  DATE(analyzed_at) as date,
  sentiment,
  COUNT(*) as count
FROM reviews
WHERE analyzed_at >= CURRENT_DATE - INTERVAL '7 days'
GROUP BY DATE(analyzed_at), sentiment
ORDER BY date DESC, sentiment;
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ë¶„ì„ì´ ë¶€ì •í™•í•¨

**ì¦ìƒ**:
- ê¸ì • ë¦¬ë·°ë¥¼ ë¶€ì •ìœ¼ë¡œ ë¶„ë¥˜
- ê°ì • ê°•ë„ê°€ ì´ìƒí•¨

**ì›ì¸**:
1. í•œêµ­ì–´ í‚¤ì›Œë“œ ì‚¬ì „ì´ ë¶ˆì¶©ë¶„
2. ë¬¸ë§¥ì„ ì´í•´í•˜ì§€ ëª»í•¨ (ì˜ˆ: "ë‚˜ì˜ì§€ ì•Šì•„ìš”" â†’ ê¸ì •ì¸ë° ë¶€ì •ìœ¼ë¡œ ë¶„ë¥˜)

**í•´ê²°**:
```javascript
// packages/server/services/sentiment-analyzer.js

// 1. í‚¤ì›Œë“œ ì¶”ê°€
sentimentKeywords: {
  positive: {
    medium: ['ë‚˜ì˜ì§€ì•Š', 'ê´œì°®', 'ê·¸ëŸ­ì €ëŸ­', 'ë¬´ë‚œ', 'ì ë‹¹'],  // ì¶”ê°€
    ...
  }
}

// 2. ë¶€ì •ì–´ ì²˜ë¦¬
const negationWords = ['ì•ˆ', 'ëª»', 'ì§€', 'ì•Š'];
if (hasPrecedingNegation(keyword)) {
  // ê°ì • ë°˜ì „
  positiveScore -= weight;
  negativeScore += weight;
}
```

### ë¬¸ì œ 2: API ë¹„ìš©ì´ ë„ˆë¬´ ë†’ìŒ

**ì¦ìƒ**:
- ì˜ˆìƒë³´ë‹¤ ë†’ì€ API ì‚¬ìš©ë£Œ
- í† í° ì‚¬ìš©ëŸ‰ì´ ê³¼ë„í•¨

**ì›ì¸**:
1. ìºì‹±ì´ ë¹„í™œì„±í™”ë¨
2. ëª¨ë“  ë¦¬ë·°ì— ëŒ€í•´ AI ì •ë°€ ë¶„ì„ ìˆ˜í–‰
3. í”„ë¡¬í”„íŠ¸ê°€ ë„ˆë¬´ ê¹€

**í•´ê²°**:
```javascript
// 1. ìºì‹± í™œì„±í™” í™•ì¸
const result = await aiService.generateReply(content, {
  saveToDb: true,  // ë°˜ë“œì‹œ true
  franchiseId: 123
});

// 2. ì¡°ê±´ë¶€ ë¶„ì„ ì„¤ì • ì¡°ì •
const needsDeepAnalysis =
  sentiment === 'negative' ||
  content.length > 150 ||  // ê¸°ì¡´ 100 â†’ 150 (ë” ì œí•œì )
  topics.length > 3 ||     // ê¸°ì¡´ 2 â†’ 3
  confidence < 0.6;        // ê¸°ì¡´ 0.7 â†’ 0.6

// 3. í”„ë¡¬í”„íŠ¸ ê°„ì†Œí™”
// buildAdvancedPrompt() í•¨ìˆ˜ì—ì„œ ë¶ˆí•„ìš”í•œ ë¶€ë¶„ ì œê±°
```

### ë¬¸ì œ 3: ì‘ë‹µ ì†ë„ê°€ ëŠë¦¼

**ì¦ìƒ**:
- ë‹µê¸€ ìƒì„±ì— 5ì´ˆ ì´ìƒ ì†Œìš”
- íƒ€ìž„ì•„ì›ƒ ë°œìƒ

**ì›ì¸**:
1. ìºì‹œê°€ ìž‘ë™í•˜ì§€ ì•ŠìŒ
2. AI API ì‘ë‹µ ì§€ì—°
3. DB ì¿¼ë¦¬ ëŠë¦¼

**í•´ê²°**:
```javascript
// 1. íƒ€ìž„ì•„ì›ƒ ì„¤ì •
const response = await fetch('https://api.openai.com/...', {
  timeout: 15000  // 15ì´ˆ íƒ€ìž„ì•„ì›ƒ
});

// 2. ë³‘ë ¬ ì²˜ë¦¬
const [analysis, cachedReply] = await Promise.all([
  analyzer.analyze(content),
  getCachedReply(reviewId)
]);

// 3. DB ì¸ë±ìŠ¤ í™•ì¸
EXPLAIN ANALYZE
SELECT * FROM sentiment_analysis_cache WHERE content_hash = '...';
```

### ë¬¸ì œ 4: ìºì‹œ ížˆíŠ¸ìœ¨ì´ ë‚®ìŒ

**ì¦ìƒ**:
- ìºì‹œ ížˆíŠ¸ìœ¨ì´ 10% ë¯¸ë§Œ
- API ë¹„ìš©ì´ ì˜ˆìƒë³´ë‹¤ ë†’ìŒ

**ì›ì¸**:
1. ë¦¬ë·° ë‚´ìš©ì´ ë„ˆë¬´ ë‹¤ì–‘í•¨
2. í•´ì‹œ ê³„ì‚° ë¡œì§ ë¬¸ì œ
3. ëŒ€ì†Œë¬¸ìž/ê³µë°± ì²˜ë¦¬ ë¶ˆì¼ì¹˜

**í•´ê²°**:
```javascript
// ì •ê·œí™”ëœ í•´ì‹œ ê³„ì‚°
function normalizeContent(content) {
  return content
    .trim()
    .toLowerCase()
    .replace(/\s+/g, ' ')        // ì—°ì† ê³µë°± ì œê±°
    .replace(/[!?.]+/g, '')      // ë¬¸ìž¥ ë¶€í˜¸ ì œê±°
    .substring(0, 200);          // ì²˜ìŒ 200ìžë§Œ ì‚¬ìš©
}

const hash = crypto.createHash('sha256')
  .update(normalizeContent(content))
  .digest('hex');
```

### ë¬¸ì œ 5: í…œí”Œë¦¿ ë‹µê¸€ë§Œ ìƒì„±ë¨

**ì¦ìƒ**:
- AI ë‹µê¸€ì´ ì•„ë‹Œ í…œí”Œë¦¿ ë‹µê¸€ë§Œ ë°˜í™˜
- `metadata.source`ê°€ 'template'

**ì›ì¸**:
1. API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•ŠìŒ
2. API í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŒ
3. ë°ëª¨ ëª¨ë“œê°€ í™œì„±í™”ë¨

**í•´ê²°**:
```bash
# 1. .env íŒŒì¼ í™•ì¸
cat .env | grep API_KEY

# 2. API í‚¤ í…ŒìŠ¤íŠ¸
node -e "
const AIServiceV2 = require('./services/ai-service-v2');
const service = new AIServiceV2({
  openaiApiKey: process.env.OPENAI_API_KEY
});
console.log('OpenAI Key:', process.env.OPENAI_API_KEY.substring(0, 10) + '...');
console.log('Demo Mode:', service.demoMode);
"

# 3. ë°ëª¨ ëª¨ë“œ ë¹„í™œì„±í™”
# .env íŒŒì¼ì—ì„œ ì œê±°
# AI_DEMO_MODE=true
```

### ë¬¸ì œ 6: DB ì €ìž¥ ì‹¤íŒ¨

**ì¦ìƒ**:
- ë¶„ì„ ê²°ê³¼ê°€ DBì— ì €ìž¥ë˜ì§€ ì•ŠìŒ
- `sentiment` ì»¬ëŸ¼ì´ NULL

**ì›ì¸**:
1. ë§ˆì´ê·¸ë ˆì´ì…˜ ë¯¸ì‹¤í–‰
2. Pool ì—°ê²° ì—†ìŒ
3. ê¶Œí•œ ë¶€ì¡±

**í•´ê²°**:
```sql
-- 1. ì»¬ëŸ¼ ì¡´ìž¬ í™•ì¸
\d reviews
-- sentiment, sentiment_strength ë“±ì´ ìžˆì–´ì•¼ í•¨

-- 2. ê¶Œí•œ í™•ì¸
GRANT ALL PRIVILEGES ON TABLE reviews TO franchise_admin;
GRANT ALL PRIVILEGES ON TABLE sentiment_analysis_cache TO franchise_admin;

-- 3. ìˆ˜ë™ ì‚½ìž… í…ŒìŠ¤íŠ¸
UPDATE reviews
SET sentiment = 'positive', sentiment_strength = 0.8
WHERE id = 1;
```

```javascript
// Pool ì—°ê²° í™•ì¸
if (!aiService.pool) {
  console.error('Poolì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!');
  aiService = new AIServiceV2({
    openaiApiKey: process.env.OPENAI_API_KEY,
    pool: require('./database/pool')  // Pool ì¶”ê°€
  });
}
```

### ë¬¸ì œ 7: í•œê¸€ ì¸ì½”ë”© ë¬¸ì œ

**ì¦ìƒ**:
- í•œê¸€ì´ ê¹¨ì ¸ì„œ ì €ìž¥ë¨
- AI ì‘ë‹µì— í•œê¸€ì´ ì´ìƒí•˜ê²Œ ë‚˜ì˜´

**ì›ì¸**:
1. DB ì¸ì½”ë”©ì´ UTF-8ì´ ì•„ë‹˜
2. Node.js í™˜ê²½ ë³€ìˆ˜ ë¯¸ì„¤ì •

**í•´ê²°**:
```sql
-- DB ì¸ì½”ë”© í™•ì¸
SHOW SERVER_ENCODING;
-- UTF8ì´ì–´ì•¼ í•¨

-- í…Œì´ë¸” ì¸ì½”ë”© í™•ì¸
SELECT pg_encoding_to_char(encoding)
FROM pg_database
WHERE datname = 'franchise_reviews';
```

```javascript
// Node.js í™˜ê²½ ì„¤ì •
process.env.LANG = 'ko_KR.UTF-8';
process.env.LC_ALL = 'ko_KR.UTF-8';

// PostgreSQL ì—°ê²° ì˜µì…˜
const pool = new Pool({
  ...config,
  client_encoding: 'UTF8'
});
```

---

## ë² ìŠ¤íŠ¸ í”„ëž™í‹°ìŠ¤

### 1. ë‹µê¸€ í’ˆì§ˆ í–¥ìƒ

**DO**:
```javascript
// âœ… êµ¬ì²´ì ì¸ í‚¤ì›Œë“œ ì¸ìš©
"ì»¤í”¼ ë§›ìžˆê²Œ ë“œì…¨ë‹¤ë‹ˆ ê¸°ì©ë‹ˆë‹¤"  // 'ì»¤í”¼', 'ë§›ìžˆ' ì¸ìš©

// âœ… ê°ì •ì— ë§žëŠ” í†¤
positive â†’ ì¹œê·¼í•˜ê³  ë”°ëœ»í•œ ðŸ˜Š
negative â†’ ì§„ì§€í•˜ê³  ì§„ì‹¬ì–´ë¦°

// âœ… ì ì ˆí•œ ê¸¸ì´
80~120ìž (ì½ê¸° íŽ¸í•œ ê¸¸ì´)
```

**DON'T**:
```javascript
// âŒ ì¼ë°˜ì ì¸ ë‹µë³€
"ì†Œì¤‘í•œ ë¦¬ë·° ê°ì‚¬í•©ë‹ˆë‹¤"  // ë„ˆë¬´ ì¼ë°˜ì 

// âŒ ê³¼ë„í•œ ì´ëª¨ì§€
"ì •ë§ì •ë§ ê°ì‚¬í•©ë‹ˆë‹¤!!! ðŸ˜ŠðŸ˜ðŸŽ‰ðŸ’•"  // ê³¼í•¨

// âŒ ë„ˆë¬´ ê¸´ ë‹µë³€
"ì €í¬ ë§¤ìž¥ì„ ë°©ë¬¸í•´ ì£¼ì…”ì„œ ì§„ì‹¬ìœ¼ë¡œ ê°ì‚¬ë“œë¦¬ë©°, ì•žìœ¼ë¡œë„..."  // 150ìž ì´ˆê³¼
```

### 2. ë¹„ìš© ìµœì í™”

```javascript
// âœ… ìºì‹± í•­ìƒ í™œì„±í™”
await aiService.generateReply(content, {
  saveToDb: true,
  franchiseId: 123
});

// âœ… ë°°ì¹˜ ì²˜ë¦¬ ì‚¬ìš©
await aiService.processBatch(reviews, {
  batchSize: 10,
  delayMs: 200
});

// âœ… ì ì ˆí•œ ëª¨ë¸ ì„ íƒ
// ê°„ë‹¨í•œ ìž‘ì—…: gpt-4o-mini
// ë³µìž¡í•œ ìž‘ì—…: gpt-4
```

### 3. ì—ëŸ¬ í•¸ë“¤ë§

```javascript
try {
  const result = await aiService.generateReply(content, options);

  if (!result.success) {
    // í´ë°± ì²˜ë¦¬
    logger.warn('AI ìƒì„± ì‹¤íŒ¨, í…œí”Œë¦¿ ì‚¬ìš©', {
      error: result.error,
      reviewId: review.id
    });

    // í…œí”Œë¦¿ ë‹µê¸€ ì‚¬ìš©
    result.reply = getTemplateReply(review);
  }

  return result;

} catch (error) {
  logger.error('ë‹µê¸€ ìƒì„± ì˜¤ë¥˜', {
    error: error.message,
    stack: error.stack,
    reviewId: review.id
  });

  // ìµœì†Œí•œì˜ ë‹µê¸€ ë°˜í™˜
  return {
    success: false,
    reply: 'ì†Œì¤‘í•œ ë¦¬ë·° ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.',
    error: error.message
  };
}
```

### 4. ëª¨ë‹ˆí„°ë§

```javascript
// ì‚¬ìš©ëŸ‰ ì¶”ì 
const stats = aiService.getUsageStats();
console.log('ì¼ì¼ ì‚¬ìš©ëŸ‰:', {
  total_requests: stats.reply_generator.analysis.requests +
                  stats.reply_generator.generation.requests,
  total_tokens: stats.reply_generator.analysis.tokens +
                stats.reply_generator.generation.tokens,
  error_rate: (stats.reply_generator.analysis.errors +
               stats.reply_generator.generation.errors) /
              stats.total_requests * 100
});

// ìºì‹œ íš¨ìœ¨ ì¶”ì 
SELECT
  COUNT(*) as total_cached,
  SUM(hit_count) as total_hits,
  AVG(hit_count) as avg_hits_per_entry,
  SUM(CASE WHEN hit_count > 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) as hit_rate
FROM sentiment_analysis_cache;
```

### 5. í…ŒìŠ¤íŠ¸

```javascript
// ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
describe('SentimentAnalyzer', () => {
  it('should classify positive review correctly', async () => {
    const analyzer = new SentimentAnalyzer(config);
    const result = await analyzer.analyze('ë§›ìžˆê³  ì¹œì ˆí•´ìš”');

    expect(result.sentiment).toBe('positive');
    expect(result.sentiment_strength).toBeGreaterThan(0.7);
    expect(result.keywords).toContain('ë§›ìžˆ');
  });

  it('should detect negative review', async () => {
    const result = await analyzer.analyze('ìµœì•…ì´ì—ìš”');

    expect(result.sentiment).toBe('negative');
    expect(result.sentiment_strength).toBeGreaterThan(0.7);
  });
});

// í†µí•© í…ŒìŠ¤íŠ¸
describe('AIServiceV2', () => {
  it('should generate contextual reply', async () => {
    const service = new AIServiceV2(config);
    const result = await service.generateReply('ì»¤í”¼ ë§›ìžˆì–´ìš”', {
      brandContext: 'ì¹´íŽ˜'
    });

    expect(result.success).toBe(true);
    expect(result.reply).toContain('ì»¤í”¼');
    expect(result.sentiment).toBe('positive');
  });
});
```

### 6. ë³´ì•ˆ

```javascript
// API í‚¤ ë³´í˜¸
// âŒ ì ˆëŒ€ í•˜ë“œì½”ë”©í•˜ì§€ ë§ ê²ƒ
const apiKey = 'sk-...';  // ê¸ˆì§€!

// âœ… í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©
const apiKey = process.env.OPENAI_API_KEY;

// âœ… .env íŒŒì¼ì„ .gitignoreì— ì¶”ê°€
// .gitignore
.env
.env.local
.env.production
```

```javascript
// SQL Injection ë°©ì§€
// âŒ ë¬¸ìžì—´ ì—°ê²°
const query = `SELECT * FROM reviews WHERE content = '${userInput}'`;  // ìœ„í—˜!

// âœ… íŒŒë¼ë¯¸í„°í™”ëœ ì¿¼ë¦¬
const query = 'SELECT * FROM reviews WHERE content = $1';
await pool.query(query, [userInput]);
```

### 7. ì„±ëŠ¥

```javascript
// Connection Pooling
const pool = new Pool({
  max: 20,                    // ìµœëŒ€ ì—°ê²° ìˆ˜
  idleTimeoutMillis: 30000,   // ìœ íœ´ ì—°ê²° íƒ€ìž„ì•„ì›ƒ
  connectionTimeoutMillis: 2000
});

// ì¸ë±ìŠ¤ ì‚¬ìš© í™•ì¸
EXPLAIN ANALYZE
SELECT * FROM reviews
WHERE franchise_id = 123
  AND sentiment = 'negative'
  AND analyzed_at >= CURRENT_DATE - INTERVAL '30 days';

// ê²°ê³¼ì— "Index Scan"ì´ ìžˆì–´ì•¼ í•¨
```

---

## ë¶€ë¡

### A. ì£¼ìš” íŒŒì¼ ìœ„ì¹˜

```
gosori/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ server/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ sentiment-analyzer.js          # ê°ì • ë¶„ì„ ì—”ì§„
â”‚   â”‚   â”‚   â”œâ”€â”€ ai-reply-generator.js          # ë‹µê¸€ ìƒì„± ì—”ì§„
â”‚   â”‚   â”‚   â”œâ”€â”€ ai-service-v2.js               # í†µí•© ì¸í„°íŽ˜ì´ìŠ¤
â”‚   â”‚   â”‚   â”œâ”€â”€ ai-service.js                  # v1 (deprecated)
â”‚   â”‚   â”‚   â””â”€â”€ review-analyzer.js             # v1 (deprecated)
â”‚   â”‚   â”œâ”€â”€ test-sentiment-system.js           # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”‚   â””â”€â”€ routes/
â”‚   â”‚       â””â”€â”€ reply-routes.js                # API ë¼ìš°íŠ¸
â”‚   â”œâ”€â”€ web-dashboard/
â”‚   â”‚   â””â”€â”€ pages/
â”‚   â”‚       â””â”€â”€ analytics/
â”‚   â”‚           â””â”€â”€ sentiment.tsx              # ê°ì • ë¶„ì„ ëŒ€ì‹œë³´ë“œ
â”‚   â””â”€â”€ desktop-app/
â”‚       â””â”€â”€ src/
â”‚           â”œâ”€â”€ ai-client-v2.js                # v2 í´ë¼ì´ì–¸íŠ¸
â”‚           â””â”€â”€ review-manager-v2.js           # v2 ë§¤ë‹ˆì €
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ v11_sentiment_analysis_enhancement.sql  # ë§ˆì´ê·¸ë ˆì´ì…˜
â”‚   â””â”€â”€ schema/
â”‚       â””â”€â”€ unified_schema.sql                 # í†µí•© ìŠ¤í‚¤ë§ˆ
â””â”€â”€ docs/
    â”œâ”€â”€ SENTIMENT_ANALYSIS_SYSTEM.md           # ì‹œìŠ¤í…œ ê°œìš”
    â””â”€â”€ SENTIMENT_REPLY_SYSTEM_DETAILED.md     # ìƒì„¸ ê°€ì´ë“œ (ì´ ë¬¸ì„œ)
```

### B. í™˜ê²½ ë³€ìˆ˜ ì „ì²´ ëª©ë¡

```env
# AI API Keys
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
DEFAULT_AI_MODEL=gpt-4o-mini

# Database
DB_HOST=localhost
DB_PORT=5432
DB_NAME=franchise_reviews
DB_USER=franchise_admin
DB_PASSWORD=your_password
DB_MAX_CONNECTIONS=20

# Server
PORT=4512
NODE_ENV=production
JWT_SECRET=your_jwt_secret

# Features
AI_DEMO_MODE=false
USE_AI_V2=true
```

### C. ì£¼ìš” SQL ì¿¼ë¦¬

**ê°ì • ë¶„í¬ ì¡°íšŒ**:
```sql
SELECT
  sentiment,
  COUNT(*) as count,
  ROUND(AVG(sentiment_strength), 2) as avg_strength
FROM reviews
WHERE franchise_id = $1
  AND analyzed_at >= $2
GROUP BY sentiment;
```

**ì£¼ì œë³„ í†µê³„**:
```sql
SELECT
  topic_name,
  COUNT(*) as mentions,
  COUNT(CASE WHEN topic_sentiment = 'positive' THEN 1 END) as positive,
  COUNT(CASE WHEN topic_sentiment = 'negative' THEN 1 END) as negative
FROM review_topics
WHERE franchise_id = $1
  AND created_at >= $2
GROUP BY topic_name
ORDER BY mentions DESC;
```

**ìºì‹œ íš¨ìœ¨ ë¶„ì„**:
```sql
SELECT
  COUNT(*) as total_entries,
  SUM(hit_count) as total_hits,
  ROUND(AVG(hit_count), 1) as avg_hits,
  COUNT(CASE WHEN hit_count > 0 THEN 1 END) as used_entries,
  ROUND(COUNT(CASE WHEN hit_count > 0 THEN 1 END) * 100.0 / COUNT(*), 1) as usage_rate
FROM sentiment_analysis_cache;
```

### D. ì°¸ê³  ë§í¬

- [OpenAI API ë¬¸ì„œ](https://platform.openai.com/docs/api-reference)
- [Anthropic Claude API](https://docs.anthropic.com/claude/reference)
- [PostgreSQL ë¬¸ì„œ](https://www.postgresql.org/docs/)
- [Node.js crypto ëª¨ë“ˆ](https://nodejs.org/api/crypto.html)

---

**ë¬¸ì„œ ë²„ì „**: v2.0.0
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-01-29
**ìž‘ì„±ìž**: ê³ ê°ì˜ì†Œë¦¬.ai ê°œë°œíŒ€
**ë¼ì´ì„ ìŠ¤**: MIT
